/**
 * xe-ajax.js v3.2.11
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 * @preserve
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.XEAjax=n()}(this,function(){"use strict";function t(t){return"undefined"!=typeof FormData&&t instanceof FormData}function n(){return"function"==typeof Blob&&"function"==typeof FormData&&"function"==typeof FileReader}function e(t){return"string"==typeof t}function o(t){return t&&"object"==typeof t}function r(t){return"function"==typeof t}function i(){return location.origin||location.protocol+"//"+location.host}function s(t,n,e){for(var o in t)t.hasOwnProperty(o)&&n.call(e,t[o],o,t)}function u(t,n,e){var r=[];return s(t,function(t,i){o(t)?r=r.concat(u(t,n+"["+i+"]",B(t))):r.push(encodeURIComponent(n+"["+(e?"":i)+"]")+"="+encodeURIComponent(t))}),r}function a(t){var n=[];return s(t,function(t,e){void 0!==t&&(o(t)?n=n.concat(u(t,e,B(t))):n.push(encodeURIComponent(e)+"="+encodeURIComponent(t)))}),n.join("&").replace(/%20/g,"+")}function c(t,n,e){if(t.forEach)t.forEach(n,e);else for(var o=0,r=t.length||0;o<r;o++)n.call(e,t[o],o,t)}function f(t){t.$context=t.$Promise=null}function h(t){return String(t).toLowerCase()}function d(t,n){this.$index=0,this.$list=function(t,n){var e=[];for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];e.push([o,r,[o,r]][n])}return e}(t,n),this.next=function(){return function(t,n){var e=t.$index++>=t.$list.length;return{done:e,value:e?void 0:n}}(this,this.$list[this.$index])}}function l(t){this._map={},t instanceof l?t.forEach(function(t,n){this.set(n,t)},this):s(t,function(t,n){this.set(n,t)},this)}function p(t){for(var n=0,e=J.length;n<e;n++)if(t===J[n][0])return n}function y(){this.onaborted=null,this._abortSignal={aborted:!1}}function m(){this.signal=new L}function b(t){return function(n){-1===t.indexOf(n)&&t.push(n)}}function v(t){var n=t.$Promise||Promise,e=n.resolve(t,t.$context);return c(I.reqQueue,function(o){e=e.then(function(e){return new n(function(t){o(e,function(){t(e)})},t.$context)}).catch(function(t){console.error(t)})}),e}function g(t,n){var e=t.$Promise||Promise,o=e.resolve(n,t.$context);return c(I.respQueue,function(n){o=o.then(function(o){return new e(function(e){n(o,function(n){n&&n.body&&n.status?e(T(n,t)):e(o)},t)},t.$context)}).catch(function(t){console.error(t)})}),o}function x(t){H(this,{url:"",body:null,params:null,signal:null},t),this.headers=new D(t.headers),this.method=String(this.method).toLocaleUpperCase(),this.bodyType=String(this.bodyType).toLowerCase(),this.signal&&r(this.signal.install)&&this.signal.install(this)}function w(t,n,e){this._request=e,this._response={body:new function(t,n){this.locked=!1,this._getBody=function(){var e=this,o=n.$Promise||Promise;return this.bodyUsed=!0,new o(function(n,o){e.locked?o(new TypeError("body stream already read")):(e.locked=!0,n(t))},n.$context)}}(t,e),bodyUsed:!1,url:e.url,status:n.status,statusText:n.statusText,redirected:302===n.status,headers:new D(n.headers||{}),type:"basic"},this._response.ok=e.validateStatus(this)}function $(t,n){return new(t.$Promise||Promise)(function(t,e){n.onload=function(){t(n.result)},n.onerror=function(){e(n.error)}},t.$context)}function T(t,e){if("function"==typeof Response&&t.constructor===Response||t.constructor===w)return t;var o={status:t.status,statusText:t.statusText,headers:t.headers};return n()?new w(t.body instanceof Blob?t.body:new Blob([JSON.stringify(t.body)]),o,e):new w(JSON.stringify(t.body),o,e)}function P(t,n){n(new TypeError("Network request failed"))}function _(t,e,o){var i=r(t.$XMLHttpRequest)?t.$XMLHttpRequest:XMLHttpRequest,s=t.xhr=new i;s._request=t,s.open(t.method,t.getUrl(),!0),t.timeout&&setTimeout(function(){s.abort()},t.timeout),t.headers.forEach(function(t,n){s.setRequestHeader(n,t)}),s.onload=function(){g(t,new w(s.response,{status:s.status,statusText:function(t){{if(1223===t.status||204===t.status)return"No Content";if(304===t.status)return"Not Modified";if(404===t.status)return"Not Found"}return(t.statusText||t.statusText||"").trim()}(s),headers:function(t){var n={};if(t.getAllResponseHeaders){var e=t.getAllResponseHeaders().trim();e&&c(e.split("\n"),function(t){var e=t.indexOf(":");n[t.slice(0,e).trim()]=t.slice(e+1).trim()})}return n}(s)},t)).then(e)},s.onerror=function(){P(0,o)},s.ontimeout=function(){P(0,o)},n()&&(s.responseType="blob"),"include"===t.credentials?s.withCredentials=!0:"omit"===t.credentials&&(s.withCredentials=!1),t.getBody().catch(function(){return null}).then(function(n){s.send(n),t.$abort&&s.abort()})}function j(t){t.script.parentNode===document.body&&document.body.removeChild(t.script);try{delete M[t.jsonpCallback]}catch(n){M[t.jsonpCallback]=void 0}}function O(t,n){j(t),n(new TypeError("JSONP request failed"))}function E(t,n,e){t.script=document.createElement("script"),v(t).then(function(){var o=t.script;if(t.jsonpCallback||(t.jsonpCallback="jsonp_xeajax_"+Date.now()+"_"+ ++Q),r(t.$jsonp))return t.$jsonp(o,t).then(function(e){g(t,T({status:200,body:e},t)).then(n)}).catch(function(t){e(t)});var i=t.getUrl();M[t.jsonpCallback]=function(e){!function(t,n,e){j(t),g(t,T(n,t)).then(e)}(t,{status:200,body:e},n)},o.type="text/javascript",o.src=i+(-1===i.indexOf("?")?"?":"&")+t.jsonp+"="+t.jsonpCallback,o.onerror=function(n){O(t,e)},t.timeout&&setTimeout(function(){O(t,e)},t.timeout),document.body.appendChild(o)})}function C(t){var n=H({},z,{headers:H({},z.headers)},t);return new(n.$Promise||Promise)(function(t,e){(n.jsonp?E:function(t,n,e){return v(t).then(function(){return G(t,n,e)})})(new x(n),t,e)},n.$context)}function R(t,n,e){var o=H({method:t,$context:C.$context,$Promise:C.$Promise},n,e);return f(C),o}function S(t){return function(){return C(t.apply(this,arguments))}}function q(t){return function(){var n=t.apply(this,arguments),e=n.$Promise||Promise;return C(n).then(function(t){return new e(function(n,e){t.json().then(function(o){(t.ok?n:e)(o)}).catch(function(t){e(null)})},this)})}}function U(t){return function(n,e){return R(t,{url:n},e)}}function A(t,n){return function(e,o,r){return R(t,H({url:e,params:o},n),r)}}function N(t){return function(n,e,o){return R(t,{url:n,body:e},o)}}function k(t){s(t,function(t,n){C[n]=r(t)?function(){var n=t.apply(C.$context,arguments);return f(C),n}:t})}var B=Array.isArray||function(t){return!!t&&t.constructor===Array},H=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++){n=arguments[e];for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t};H(l.prototype,{set:function(t,n){this._map[h(t)]=n},get:function(t){var n=h(t);return this.has(n)?this._map[n]:null},append:function(t,n){var e=h(t);this.has(e)?this._map[e]=this._map[e]+", "+n:this._map[e]=""+n},has:function(t){return this._map.hasOwnProperty(h(t))},keys:function(){return new d(this._map,0)},values:function(){return new d(this._map,1)},entries:function(){return new d(this._map,2)},delete:function(t){delete this._map[h(t)]},forEach:function(t,n){s(this._map,function(e,o,r){t.call(n,e,o,this)},this)}});var D="undefined"==typeof Headers?l:Headers,J=[];Object.defineProperty(y.prototype,"aborted",{get:function(){return this._abortSignal.aborted}}),H(y.prototype,{install:function(t){if(t.signal){var n=p(t.signal);void 0===n?J.push([t.signal,[t]]):J[n][1].push(t)}}}),H(m.prototype,{abort:function(){var t=p(this.signal);void 0!==t&&(c(J[t][1],function(n){n.abort(),J[t][0]._abortSignal.aborted=!0}),J.splice(t,1))}});var L=y,F=m,I={reqQueue:[],respQueue:[]},X={request:{use:b(I.reqQueue)},response:{use:b(I.respQueue)}};X.request.use(function(n,e){n.body&&"GET"!==n.method&&"HEAD"!==n.method&&(t(n.body)||(n.headers.set("Content-Type","application/x-www-form-urlencoded"),"json-data"!==n.bodyType&&"json_data"!==n.bodyType||n.headers.set("Content-Type","application/json; charset=utf-8"))),function(t){return!(!/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(t)||RegExp.$1===location.protocol&&RegExp.$2.split("/")[0]===location.host)}(n.getUrl())&&n.headers.set("X-Requested-With","XMLHttpRequest"),e()}),H(x.prototype,{abort:function(){this.xhr&&this.xhr.abort(),this.$abort=!0},getUrl:function(){var n=this.url,o="";if(n){if(r(this.transformParams)&&(this.params=this.transformParams(this.params||{},this)),this.params&&!t(this.params)){var s=function(t,n){if(t.includes)return t.includes(n);for(var e=0,o=t.length||0;e<o;e++)if(t[e]===n)return!0;return!1}(["no-store","no-cache","reload"],this.cache)?{_t:Date.now()}:{};o=e(this.params)?this.params:(r(this.paramsSerializer)?this.paramsSerializer:a)(H(s,this.params),this)}return o&&(n+=(-1===n.indexOf("?")?"?":"&")+o),/\w+:\/{2}.*/.test(n)?n:0===n.indexOf("/")?i()+n:this.baseURL.replace(/\/$/,"")+"/"+n}return n},getBody:function(){var n=this;return new(n.$Promise||Promise)(function(o,i){var s=null;if(n.body&&"GET"!==n.method&&"HEAD"!==n.method)try{r(n.transformBody)&&(n.body=n.transformBody(n.body||{},n)||n.body),s=r(n.stringifyBody)?n.stringifyBody(n.body,n)||null:t(n.body)?n.body:e(n.body)?n.body:"form-data"===n.bodyType||"form_data"===n.bodyType?a(n.body):JSON.stringify(n.body)}catch(t){console.error(t)}o(s)},n.$context)}}),c(["body","bodyUsed","url","headers","status","statusText","ok","redirected","type"],function(t){Object.defineProperty(w.prototype,t,{get:function(){return this._response[t]}})}),H(w.prototype,{clone:function(){return new w(this.body,{status:this.status,statusText:this.statusText,headers:this.headers},this._request)},json:function(){return this.text().then(function(t){return JSON.parse(t)})},text:function(){return this.body._getBody()}}),n()&&H(w.prototype,{text:function(){var t=this._request;return this.blob().then(function(n){var e=new FileReader,o=$(t,e);return e.readAsText(n),o})},blob:function(){return this.body._getBody()},arrayBuffer:function(){var t=this._request;return this.blob().then(function(n){var e=new FileReader,o=$(t,e);return e.readAsArrayBuffer(n),o})},formData:function(){return this.text().then(function(t){var n=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),o=e.shift().replace(/\+/g," "),r=e.join("=").replace(/\+/g," ");n.append(decodeURIComponent(o),decodeURIComponent(r))}}),n})}});var G=self.fetch?function(t,n,e){return(t.signal?_:function(t,n,e){var o=r(t.$fetch)?t.$fetch:fetch;t.getBody().then(function(r){var i={_request:t,method:t.method,cache:t.cache,credentials:t.credentials,body:r,headers:t.headers};t.timeout&&setTimeout(function(){P(0,e)},t.timeout),o(t.getUrl(),i).then(function(e){g(t,T(e,t)).then(n)}).catch(function(t){P(0,e)})})}).apply(this,arguments)}:_,Q=0,M="undefined"==typeof window?this:window,z={method:"GET",baseURL:function(){var t=location.pathname,n=function(t,n){if(r(t.lastIndexOf))return t.lastIndexOf(n);for(var e=t.length-1;e>=0;e--)if(n===t[e])return e;return-1}(t,"/")+1;return i()+(n===t.length?t:t.substring(0,n))}(),cache:"default",credentials:"same-origin",bodyType:"json-data",log:!1,headers:{},validateStatus:function(t){return t.status>=200&&t.status<300}},W=C,K=U("HEAD"),V=U("DELETE"),Y=A("GET",{jsonp:"callback"}),Z=A("GET"),tt=N("POST"),nt=N("PUT"),et=N("PATCH"),ot=F,rt=S(K),it=S(V),st=S(Y),ut=S(Z),at=S(tt),ct=S(nt),ft=S(et),ht=q(K),dt=q(V),lt=q(Y),pt=q(Z),yt=q(tt),mt=q(nt),bt=q(et),vt={doAll:function(t){var n=C.$Promise||Promise,e=C.$context;return f(C),n.all(t.map(function(t){return o(t)?C(H({$context:e,$Promise:n},t)):t}),e)},ajax:W,fetch:function(t,n){return ut(t,null,n)},fetchGet:ut,fetchPost:at,fetchPut:ct,fetchDelete:it,fetchPatch:ft,fetchHead:rt,fetchJsonp:st,getJSON:pt,postJSON:yt,putJSON:mt,deleteJSON:dt,patchJSON:bt,headJSON:ht,jsonp:lt};return H(C,{use:function(t){t.install(C),z.log&&console.info("["+C.$name+"] Ready. Detected "+t.$name+" v"+t.version)},setup:function(t){H(z,t)},mixin:k,AbortController:ot,serialize:a,interceptors:X,version:"3.2.11",$name:"XEAjax"}),k(vt),C});