/*!
 * xe-ajax.js v3.0.4
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.XEAjax=a())}(this,function(){function r(Y){return typeof FormData!=="undefined"&&Y instanceof FormData}function v(Y){if(/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(Y.url)){if(RegExp.$1!==location.protocol||RegExp.$2.split("/")[0]!==location.host){return true}}return false}function K(Y){return Y&&typeof Y==="object"}function q(Y){return typeof Y==="function"}function G(aa,ab,Z){for(var Y in aa){if(aa.hasOwnProperty(Y)){ab.call(Z,aa[Y],Y,aa)}}}function R(Z,ab,aa){var Y=[];G(Z,function(ad,ac){if(K(ad)){Y=Y.concat(R(ad,ab+"["+ac+"]",Array.isArray(ad)))}else{Y.push(encodeURIComponent(ab+"["+(aa?"":ac)+"]")+"="+encodeURIComponent(ad))}});return Y}function e(Y){var Z=[];G(Y,function(ab,aa){if(ab!==undefined){if(K(ab)){Z=Z.concat(R(ab,aa,Array.isArray(ab)))}else{Z.push(encodeURIComponent(aa)+"="+encodeURIComponent(ab))}}});return Z.join("&").replace(/%20/g,"+")}var j=[];function B(aa){for(var Z=0,Y=j.length;Z<Y;Z++){if(aa===j[Z][0]){return Z}}}function A(Z){if(Z.signal){var Y=B(Z.signal);if(Y===undefined){j.push([Z.signal,[Z]])}else{j[Y][1].push(Z)}}}function H(){}function y(){this.signal=new H()}Object.assign(y.prototype,{abort:function(){var Y=B(this.signal);if(Y!==undefined){j[Y][1].forEach(function(Z){setTimeout(function(){Z.abort()})});j.splice(Y,1)}}});function W(Y){Object.assign(this,{url:"",body:null,params:null,signal:null},Y);this.ABORT_RESPONSE=undefined;this.method=String(this.method).toLocaleUpperCase();this.crossOrigin=v(this);if(Y&&Y.jsonp){this.script=document.createElement("script")}else{this.xhr=Y.getXMLHttpRequest(this)}A(this)}Object.assign(W.prototype,{abort:function(Y){this.xhr.abort(Y)},setHeader:function(Y,Z){this.headers[Y]=Z},getHeader:function(){return this.headers[name]},deleteHeader:function(Y){delete this.headers[Y]},clearHeader:function(){this.headers={}},getUrl:function(){var Y=this.url;var Z="";if(Y){if(this.params&&!r(this.params)){Z=q(this.paramsSerializer)?this.paramsSerializer(this):e(this.params)}if(Z){Y+=(Y.indexOf("?")===-1?"?":"&")+Z}if(/\w+:\/{2}.*/.test(Y)){return Y}return this.baseURL.replace(/\/$/,"")+"/"+Y.replace(/^\//,"")}return Y},getBody:function(){var Y=this;return new Promise(function(ab,aa){var Z=null;if(Y.body&&Y.method!=="GET"){try{if(q(Y.transformBody)){Y.body=Y.transformBody(Y.body,Y)||Y.body}if(q(Y.stringifyBody)){Z=Y.stringifyBody(Y.body,Y)||null}else{if(r(Y.body)){Z=Y.body}else{if(String(Y.bodyType).toLocaleUpperCase()==="FROM_DATA"){Z=e(Y.body)}else{Z=JSON.stringify(Y.body)}}}}catch(ac){console.error(ac)}}ab(Z)})}});function m(Y){this.locked=false;this._xhr=Y}Object.assign(m.prototype,{_getBody:function(){var Y=this;var Z=this._xhr;return new Promise(function(ac,ab){var aa={responseText:"",response:Z};if(Z&&Z.response!==undefined&&Z.status!==undefined){if(Z.responseText){aa.responseText=Z.responseText;try{aa.response=JSON.parse(Z.responseText)}catch(ad){aa.response=null}}else{aa.response=Z.response;aa.responseText=JSON.stringify(Z.response)}}else{aa.responseText=JSON.stringify(aa.response)}if(Y.locked){ab(new TypeError("body stream already read"))}else{Y.locked=true;ac(aa)}})}});function M(Z,ab){var Y=this;this.body=new m(ab);this.bodyUsed=false;this.url=Z.url;this.headers={};this.status=0;this.statusText="";this.ok=false;this.redirected=false;this.json=function(){return this.body._getBody().then(function(ac){Y.bodyUsed=true;return ac.response})};this.text=function(){return this.body._getBody().then(function(ac){Y.bodyUsed=true;return ac.responseText})};if(ab&&ab.response!==undefined&&ab.status!==undefined){this.status=ab.status;this.redirected=this.status===302;this.ok=Z.getPromiseStatus(this);if(this.status===1223||this.status===204){this.statusText="No Content"}else{if(this.status===304){this.statusText="Not Modified"}else{this.statusText=(ab.statusText||this.statusText).trim()}}if(ab.getAllResponseHeaders){var aa=ab.getAllResponseHeaders().trim();if(aa){aa.split("\n").forEach(function(ad){var ac=ad.indexOf(":");this.headers[ad.slice(0,ac).trim()]=ad.slice(ac+1).trim()},this)}}}}var x=[];var D=[];function I(Y){return function(Z){if(Y.indexOf(Z)===-1){Y.push(Z)}}}function L(Z,Y){var aa=Promise.resolve(Y);Z.forEach(function(ab){aa=aa.then(function(ac){return new Promise(function(ad){ab(ac,function(){ad(ac)})})}).catch(function(ac){console.error(ac)})});return aa}function u(Y){return L(x,Y)}function s(Y){return L(D,Y)}var J={request:{use:I(x)},response:{use:I(D)}};J.request.use(function(Z,Y){if(!r(Z.method==="GET"?Z.params:Z.body)){if(Z.method!=="GET"&&String(Z.bodyType).toLocaleUpperCase()==="JSON_DATA"){Z.setHeader("Content-Type","application/json; charset=utf-8")}else{Z.setHeader("Content-Type","application/x-www-form-urlencoded")}}if(Z.crossOrigin){Z.setHeader("X-Requested-With","XMLHttpRequest")}Y()});var a=typeof window==="undefined"?this:window;
var Q={method:"GET",baseURL:location.origin,async:true,credentials:true,bodyType:"JSON_DATA",headers:{Accept:"application/json, text/plain, */*;"},getXMLHttpRequest:function(){return new XMLHttpRequest()},getPromiseStatus:function(Y){return(Y.status>=200&&Y.status<300)||Y.status===304}};function b(Y){return new Promise(function(aa,Z){return(Y&&Y.jsonp?h:O)(new W(Object.assign({},Q,{headers:Object.assign({},Q.headers)},Y)),aa,Z)})}function w(Y,ab,aa,Z){s(new M(Y,ab)).then(function(ac){aa(ac)})}function O(Y,aa,Z){var ab=Y.xhr;u(Y).then(function(){ab.open(Y.method,Y.getUrl(),Y.async!==false);if(Y.timeout&&!isNaN(Y.timeout)){ab.timeout=Y.timeout}G(Y.headers,function(ad,ac){ab.setRequestHeader(ac,ad)});ab.onreadystatechange=function(){if(ab.readyState===4){w(Y,ab,aa,Z)}};if(Y.credentials==="include"){Y.xhr.withCredentials=true}else{if(Y.credentials==="omit"){Y.xhr.withCredentials=false}}Y.getBody().then(function(ac){ab.send(ac)}).catch(function(){ab.send()})})}var g=0;function h(aa,ac,ab){var Y=aa.script;var Z=aa.getUrl();if(!aa.jsonpCallback){aa.jsonpCallback="_xeajax_jsonp"+(++g)}a[aa.jsonpCallback]=function(ad){k(aa,{status:200,response:ad},ac,ab)};Y.type="text/javascript";Y.src=Z+(Z.indexOf("?")===-1?"?":"&")+aa.jsonp+"="+aa.jsonpCallback;Y.onerror=function(ad){k(aa,{status:500,response:null},ac,ab)};if(q(aa.sendJSONP)){aa.sendJSONP(Y,aa,ac,ab)}else{document.body.appendChild(Y)}}function k(Z,ac,ab,aa){var Y=new M(Z,ac);delete a[Z.jsonpCallback];if(q(Z.sendEndJSONP)){Z.sendEndJSONP(Z.script,Z)}else{document.body.removeChild(Z.script)}Y.json().then(function(ad){(Y.ok?ab:aa)(ad)}).catch(function(ad){aa(ad)})}var i=function i(Y){Object.assign(Q,Y)};function X(aa,Z,Y){return b(Object.assign({method:aa},Z,Y))}function V(Y){return function(){return Y.apply(this,arguments).then(function(Z){return new Promise(function(ab,aa){Z.json().then(function(ac){(Z.ok?ab:aa)(ac)}).catch(function(ac){aa(ac)})})})}}var E=b;function n(Y){return Promise.all(Y.map(function(Z){if(Z instanceof Promise){return Z}else{if(Z&&K(Z)){return E(Z)}}return Z}))}function p(Y,aa,Z){return X("GET",K(Y)?{}:{url:Y,params:aa},Z)}function z(Z,Y,aa){return X("POST",K(Z)?{}:{url:Z,body:Y},aa)}function c(Z,Y,aa){return X("PUT",K(Z)?{}:{url:Z,body:Y},aa)}function o(Z,Y,aa){return X("PATCH",K(Z)?{}:{url:Z,body:Y},aa)}function f(Z,Y,aa){return X("DELETE",K(Z)?{}:{url:Z,body:Y},aa)}function l(Y,aa,Z){return X("GET",{url:Y,params:aa,jsonp:"callback"},Z)}var N=V(p);var P=V(z);var d=V(c);var t=V(o);var T=V(f);var C=y;var F={doAll:n,fetchGet:p,getJSON:N,fetchPost:z,postJSON:P,fetchPut:c,putJSON:d,fetchPatch:o,patchJSON:t,fetchDelete:f,deleteJSON:T,jsonp:l,setup:i,interceptors:J,AjaxController:C};function U(Y){return Object.assign(b,Y)}function S(Y){Y.install(b)}U(F);b.use=S;b.mixin=U;return b}));