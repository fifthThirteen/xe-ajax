/**
 * xe-ajax.js v3.4.0
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 * @preserve
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.XEAjax=e()}(this,function(){"use strict";function t(e,n,o){var r=[];return w.objectEach(e,function(e,i){w.isPlainObject(e)||w.isArray(e)?r=r.concat(t(e,n+"["+i+"]",w.isArray(e))):r.push(encodeURIComponent(n+"["+(o?"":i)+"]")+"="+encodeURIComponent(e))}),r}function e(t){return String(t).toLowerCase()}function n(t,e){this.$index=0,this.$list=function(t,e){var n=[];for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];n.push([o,r,[o,r]][e])}return n}(t,e),this.next=function(){return function(t,e){var n=t.$index++>=t.$list.length;return{done:n,value:n?void 0:e}}(this,this.$list[this.$index])}}function o(t){this._map={},t instanceof E?t.forEach(function(t,e){this.set(e,t)},this):w.objectEach(t,function(t,e){this.set(e,t)},this)}function r(){this.onaborted=null,this._abortSignal={aborted:!1}}function i(t){for(var e=0,n=T.length;e<n;e++)if(t===T[e][0])return e}function s(){this.signal=new r}function a(t){return function(e){-1===t.indexOf(e)&&t.push(e)}}function u(t){w.objectAssign(this,{url:"",body:null,params:null,signal:null},t),this.headers=new E(t.headers),this.method=String(this.method).toLocaleUpperCase(),this.bodyType=String(this.bodyType).toLowerCase(),this.signal&&w.isFunction(this.signal.install)&&this.signal.install(this)}function c(t,e,n){this._body=t,this._request=n,this._response={body:new function(t,e,n){this.locked=!1,this._getBody=function(){var o=this,r=e.$Promise||Promise;return n._response.bodyUsed=!0,new r(function(e,n){o.locked?n(new TypeError("body stream already read")):(o.locked=!0,e(t))},e.$context)}}(t,n,this),bodyUsed:!1,url:n.url,status:e.status,statusText:e.statusText,redirected:302===e.status,headers:new E(e.headers||{}),type:"basic"},this._response.ok=n.validateStatus(this)}function f(t,e){return new(t.$Promise||Promise)(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}},t.$context)}function d(t,e,n){var o=null,r=w.isFunction(t.$fetch)?t.$fetch:self.fetch,i={_request:t,method:t.method,cache:t.cache,credentials:t.credentials,body:t.getBody(),headers:t.headers};t.timeout&&(o=setTimeout(function(){n(new TypeError("Request timeout."))},t.timeout)),t.signal&&t.signal.aborted?n(new TypeError("The user aborted a request.")):r(t.getUrl(),i).then(function(n){clearTimeout(o),O.responseInterceptor(t,_.toResponse(n,t)).then(e)}).catch(n)}function h(t){t.script.parentNode===document.body&&document.body.removeChild(t.script);try{delete H[t.jsonpCallback]}catch(e){H[t.jsonpCallback]=void 0}}function p(t,e){h(t),e(new TypeError("JSONP request failed"))}function l(t){var e=w.objectAssign({},A,{headers:w.objectAssign({},A.headers)},t);return new(e.$Promise||Promise)(function(t,n){(e.jsonp?U.sendJSONP:q.fetchRequest)(new u(e),t,n)},e.$context)}function y(t,e,n){var o=w.objectAssign({method:t,$context:l.$context,$Promise:l.$Promise},e,n);return w.clearXEAjaxContext(l),o}function b(t){return function(){return l(t.apply(this,arguments))}}function m(t){return function(){var e=t.apply(this,arguments),n=e.$Promise||Promise;return l(e).then(function(t){return new n(function(e,n){var o=t.ok?e:n;t.clone().json().catch(function(e){return t.clone().text()}).then(function(e){o({data:e,ok:t.ok,status:t.status,statusText:t.statusText,headers:function(t){var e={};return t.headers.forEach(function(t,n){e[n]=t}),e}(t)})})},this)})}}function g(t){return function(){return t.apply(this,arguments).then(function(t){return t.data}).catch(function(t){return t.data})}}function v(t){return function(e,n){return y(t,{url:e},n)}}function x(t,e){return function(n,o,r){return y(t,w.objectAssign({url:n,params:o},e),r)}}function j(t){return function(e,n,o){return y(t,{url:e,body:n},o)}}var w={isArray:Array.isArray||function(t){return!!t&&t.constructor===Array},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isCrossOrigin:function(t){return!("undefined"==typeof location||!/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(t)||RegExp.$1===location.protocol&&RegExp.$2.split("/")[0]===location.host)},isSupportAdvanced:function(){return"function"==typeof Blob&&"function"==typeof FormData&&"function"==typeof FileReader},isString:function(t){return"string"==typeof t},isObject:function(t){return t&&"object"==typeof t},isPlainObject:function(t){return!!t&&t.constructor===Object},isFunction:function(t){return"function"==typeof t},getLocatOrigin:function(){return"undefined"==typeof location?"":location.origin||location.protocol+"//"+location.host},getBaseURL:function(){if("undefined"==typeof location)return"";var t=location.pathname,e=w.lastIndexOf(t,"/")+1;return w.getLocatOrigin()+(e===t.length?t:t.substring(0,e))},lastIndexOf:function(t,e){if(w.isFunction(t.lastIndexOf))return t.lastIndexOf(e);for(var n=t.length-1;n>=0;n--)if(e===t[n])return n;return-1},objectEach:function(t,e,n){for(var o in t)t.hasOwnProperty(o)&&e.call(n,t[o],o,t)},serialize:function(e){var n=[];return w.objectEach(e,function(e,o){void 0!==e&&(w.isPlainObject(e)||w.isArray(e)?n=n.concat(t(e,o,w.isArray(e))):n.push(encodeURIComponent(o)+"="+encodeURIComponent(e)))}),n.join("&").replace(/%20/g,"+")},objectAssign:Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}return t},arrayEach:function(t,e,n){if(t.forEach)t.forEach(e,n);else for(var o=0,r=t.length||0;o<r;o++)e.call(n,t[o],o,t)},arrayIncludes:function(t,e){if(t.includes)return t.includes(e);for(var n=0,o=t.length||0;n<o;n++)if(t[n]===e)return!0;return!1},clearXEAjaxContext:function(t){t.$context=t.$Promise=null}},A={method:"GET",baseURL:w.getBaseURL(),cache:"default",credentials:"same-origin",bodyType:"json-data",log:!1,headers:{Accept:"application/json, text/plain, */*"},validateStatus:function(t){return t.status>=200&&t.status<300}};w.objectAssign(o.prototype,{set:function(t,n){this._map[e(t)]=n},get:function(t){var n=e(t);return this.has(n)?this._map[n]:null},append:function(t,n){var o=e(t);this.has(o)?this._map[o]=this._map[o]+", "+n:this._map[o]=""+n},has:function(t){return this._map.hasOwnProperty(e(t))},keys:function(){return new n(this._map,0)},values:function(){return new n(this._map,1)},entries:function(){return new n(this._map,2)},delete:function(t){delete this._map[e(t)]},forEach:function(t,e){w.objectEach(this._map,function(n,o,r){t.call(e,n,o,this)},this)}});var E="function"==typeof Headers?Headers:o;Object.defineProperty(r.prototype,"aborted",{get:function(){return this._abortSignal.aborted}});var T=[];w.objectAssign(r.prototype,{install:function(t){if(t.signal){var e=i(t.signal);void 0===e?T.push([t.signal,[t]]):T[e][1].push(t)}}}),w.objectAssign(s.prototype,{abort:function(){var t=i(this.signal);void 0!==t&&(w.arrayEach(T[t][1],function(e){e.abort(),T[t][0]._abortSignal.aborted=!0}),T.splice(t,1))}});var $="function"==typeof AbortController?AbortController:s,P={reqQueue:[],respQueue:[]},R={request:{use:a(P.reqQueue)},response:{use:a(P.respQueue)}};R.request.use(function(t,e){t.body&&"GET"!==t.method&&"HEAD"!==t.method&&(w.isFormData(t.body)||(t.headers.set("Content-Type","application/x-www-form-urlencoded"),"json-data"!==t.bodyType&&"json_data"!==t.bodyType||t.headers.set("Content-Type","application/json; charset=utf-8"))),w.isCrossOrigin(t.getUrl())&&t.headers.set("X-Requested-With","XMLHttpRequest"),e()});var O={interceptors:R,requestInterceptor:function(t){var e=t.$Promise||Promise,n=e.resolve(t,t.$context);return w.arrayEach(P.reqQueue,function(o){n=n.then(function(n){return new e(function(t){o(n,function(){t(n)})},t.$context)}).catch(function(t){console.error(t)})}),n},responseInterceptor:function(t,e){var n=t.$Promise||Promise,o=n.resolve(e,t.$context);return w.arrayEach(P.respQueue,function(e){o=o.then(function(o){return new n(function(n){e(o,function(e){e&&e.body&&e.status?n(_.toResponse(e,t)):n(o)},t)},t.$context)}).catch(function(t){console.error(t)})}),o}};w.objectAssign(u.prototype,{abort:function(){this.xhr&&this.xhr.abort(),this.$abort=!0},getUrl:function(){var t=this.url,e="";if(t){var n=w.arrayIncludes(["no-store","no-cache","reload"],this.cache)?{_t:Date.now()}:{};return w.isFunction(this.transformParams)&&(this.params=this.transformParams(this.params||{},this)),(e=this.params&&!w.isFormData(this.params)?w.isString(this.params)?this.params:(w.isFunction(this.paramsSerializer)?this.paramsSerializer:w.serialize)(w.objectAssign(n,this.params),this):w.serialize(n))&&(t+=(-1===t.indexOf("?")?"?":"&")+e),/\w+:\/{2}.*/.test(t)?t:0===t.indexOf("/")?w.getLocatOrigin()+t:this.baseURL.replace(/\/$/,"")+"/"+t}return t},getBody:function(){var t=null,e=this.body;if(e&&"GET"!==this.method&&"HEAD"!==this.method)try{w.isFunction(this.transformBody)&&(e=this.body=this.transformBody(e,this)||e),t=w.isFunction(this.stringifyBody)?this.stringifyBody(e,this)||null:w.isFormData(e)?e:w.isString(e)?e:"form-data"===this.bodyType||"form_data"===this.bodyType?w.serialize(e):JSON.stringify(e)}catch(t){console.error(t)}return t}}),w.arrayEach(["body","bodyUsed","url","headers","status","statusText","ok","redirected","type"],function(t){Object.defineProperty(c.prototype,t,{get:function(){return this._response[t]}})}),w.objectAssign(c.prototype,{clone:function(){if(this.bodyUsed)throw new TypeError("Failed to execute 'clone' on 'Response': Response body is already used");return new c(this._body,{status:this.status,statusText:this.statusText,headers:this.headers},this._request)},json:function(){return this.text().then(function(t){return JSON.parse(t)})},text:function(){return this.body._getBody(this)}}),w.isSupportAdvanced()&&w.objectAssign(c.prototype,{text:function(){var t=this._request;return this.blob().then(function(e){var n=new FileReader,o=f(t,n);return n.readAsText(e),o})},blob:function(){return this.body._getBody(this)},arrayBuffer:function(){var t=this._request;return this.blob().then(function(e){var n=new FileReader,o=f(t,n);return n.readAsArrayBuffer(e),o})},formData:function(){return this.text().then(function(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),o=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(r))}}),e})}});var _={toResponse:function(t,e){if("function"==typeof Response&&t.constructor===Response||t.constructor===c)return t;var n={status:t.status,statusText:t.statusText,headers:t.headers};return w.isSupportAdvanced()?new c(t.body instanceof Blob?t.body:new Blob([w.isString(t.body)?t.body:JSON.stringify(t.body)]),n,e):new c(w.isString(t.body)?t.body:JSON.stringify(t.body),n,e)}},S={sendXHR:function(t,e,n){var o=w.isFunction(t.$XMLHttpRequest)?t.$XMLHttpRequest:XMLHttpRequest,r=t.xhr=new o;r._request=t,r.open(t.method,t.getUrl(),!0),t.timeout&&setTimeout(function(){r.abort()},t.timeout),t.headers.forEach(function(t,e){r.setRequestHeader(e,t)}),r.onload=function(){O.responseInterceptor(t,new c(r.response,{status:r.status,statusText:r.statusText,headers:function(t){var e={};if(t.getAllResponseHeaders){var n=t.getAllResponseHeaders().trim();n&&w.arrayEach(n.split("\n"),function(t){var n=t.indexOf(":");e[t.slice(0,n).trim()]=t.slice(n+1).trim()})}return e}(r)},t)).then(e)},r.onerror=function(){n(new TypeError("Network request failed"))},r.ontimeout=function(){n(new TypeError("Request timeout."))},r.onabort=function(){n(new TypeError("The user aborted a request."))},w.isSupportAdvanced()&&(r.responseType="blob"),"include"===t.credentials?r.withCredentials=!0:"omit"===t.credentials&&(r.withCredentials=!1),r.send(t.getBody()),t.$abort&&r.abort()}},C="undefined"==typeof XMLHttpRequest&&"undefined"!=typeof process?httpExports.sendHttp:"undefined"!=typeof self&&self.fetch?function(t,e,n){return function(t){return t.$fetch?t.signal?S.sendXHR:d:"undefined"!=typeof self&&self.fetch?"function"==typeof AbortController&&"function"==typeof AbortSignal?d:t.signal?S.sendXHR:d:S.sendXHR}(t).apply(this,arguments)}:S.sendXHR,q={fetchRequest:function(t,e,n){return O.requestInterceptor(t).then(function(){return C(t,e,n)})}},F=0,H="undefined"==typeof window?this:window,U={sendJSONP:function(t,e,n){t.script=document.createElement("script"),O.requestInterceptor(t).then(function(){var o=t.script;if(t.jsonpCallback||(t.jsonpCallback="jsonp_xeajax_"+Date.now()+"_"+ ++F),w.isFunction(t.$jsonp))return t.$jsonp(o,t).then(function(n){O.responseInterceptor(t,_.toResponse({status:200,body:n},t)).then(e)}).catch(function(t){n(t)});var r=t.getUrl();H[t.jsonpCallback]=function(n){!function(t,e,n){h(t),O.responseInterceptor(t,_.toResponse(e,t)).then(n)}(t,{status:200,body:n},e)},o.type="text/javascript",o.src=r+(-1===r.indexOf("?")?"?":"&")+t.jsonp+"="+t.jsonpCallback,o.onerror=function(e){p(t,n)},t.timeout&&setTimeout(function(){p(t,n)},t.timeout),document.body.appendChild(o)})}};l.version="3.4.0",l.use=function(t){t.install(l)},l.setup=function(t){w.objectAssign(A,t)};var I=v("HEAD"),k=v("DELETE"),B=x("GET",{jsonp:"callback"}),D=x("GET"),L=j("POST"),X=j("PUT"),J=j("PATCH"),N=b(I),z=b(k),G=b(B),Q=b(D),M=b(L),W=b(X),K=b(J),V=m(D),Y=m(L),Z=m(X),tt=m(k),et=m(J),nt=m(I),ot=m(B),rt={doAll:function(t){var e=l.$Promise||Promise,n=l.$context;return w.clearXEAjaxContext(l),e.all(t.map(function(t){return t instanceof e||t instanceof Promise?t:w.isObject(t)?l(w.objectAssign({$context:n,$Promise:e},t)):t}),n)},ajax:l,fetch:function(t,e){return Q(t,null,e)},fetchGet:Q,fetchPost:M,fetchPut:W,fetchDelete:z,fetchPatch:K,fetchHead:N,fetchJsonp:G,doGet:V,doPost:Y,doPut:Z,doDelete:tt,doPatch:et,doHead:nt,doJsonp:ot,getJSON:g(V),postJSON:g(Y),putJSON:g(Z),deleteJSON:g(tt),patchJSON:g(et),headJSON:g(nt),jsonp:g(ot)};return l.mixin=function(t){w.objectEach(t,function(t,e){l[e]=w.isFunction(t)?function(){var e=t.apply(l.$context,arguments);return w.clearXEAjaxContext(l),e}:t})},w.objectAssign(l,{serialize:w.serialize,interceptors:O.interceptors,AbortController:$}),l.mixin(rt),l});