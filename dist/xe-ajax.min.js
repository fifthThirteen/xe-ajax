/*!
 * xe-ajax.js v3.1.6
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.XEAjax=a())}(this,function(){var J=Array.isArray||function(aq){return aq?aq.constructor===Array:false};function y(aq){return typeof FormData!=="undefined"&&aq instanceof FormData}function E(aq){if(/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(aq.url)){if(RegExp.$1!==location.protocol||RegExp.$2.split("/")[0]!==location.host){return true}}return false}function X(aq){return aq&&typeof aq==="object"}function x(aq){return typeof aq==="function"}function e(){return location.origin||(location.protocol+"//"+location.host)}function w(){var aq=location.pathname;var ar=T(aq,"/")+1;return e()+(ar===aq.length?aq:aq.substring(0,ar))}function T(at,ar){if(x(at.lastIndexOf)){return at.lastIndexOf(ar)}else{for(var aq=at.length-1;aq>=0;aq--){if(ar===at[aq]){return aq}}}return -1}function C(at,au,ar){for(var aq in at){if(at.hasOwnProperty(aq)){au.call(ar,at[aq],aq,at)}}}function ae(ar,au,at){var aq=[];C(ar,function(aw,av){if(X(aw)){aq=aq.concat(ae(aw,au+"["+av+"]",J(aw)))}else{aq.push(encodeURIComponent(au+"["+(at?"":av)+"]")+"="+encodeURIComponent(aw))}});return aq}function h(aq){var ar=[];C(aq,function(au,at){if(au!==undefined){if(X(au)){ar=ar.concat(ae(au,at,J(au)))}else{ar.push(encodeURIComponent(at)+"="+encodeURIComponent(au))}}});return ar.join("&").replace(/%20/g,"+")}var d=Object.assign||function(av){for(var au,ar=1,aq=arguments.length;ar<aq;ar++){au=arguments[ar];for(var at in au){if(au.hasOwnProperty(at)){av[at]=au[at]}}}return av};function l(av,au,at){if(av.forEach){av.forEach(au,at)}else{for(var ar=0,aq=av.length||0;ar<aq;ar++){au.call(at||b,av[ar],ar,av)}}}function ak(aq){aq.$context=aq.$Promise=null}function al(aq){return String(aq).toLowerCase()}function P(){this._state={};this.set=function(aq,ar){this._state[al(aq)]=[ar]};this.get=function(aq){var ar=al(aq);return this.has(ar)?this._state[ar].join(", "):null};this.append=function(aq,at){var ar=al(aq);if(this.has(ar)){return this._state[ar].push(at)}else{this.set(ar,at)}};this.has=function(aq){return !!this._state[al(aq)]};this["delete"]=function(aq){delete this._state[al(aq)]}}d(P.prototype,{forEach:function(ar,aq){C(this._state,function(av,at,au){ar.call(aq,av.join(", "),au)})}});var n=[];function N(at){for(var ar=0,aq=n.length;ar<aq;ar++){if(at===n[ar][0]){return ar}}}function M(ar){if(ar.signal){var aq=N(ar.signal);if(aq===undefined){n.push([ar.signal,[ar]])}else{n[aq][1].push(ar)}}}function U(){}function H(){this.signal=new U()}d(H.prototype,{abort:function(){var aq=N(this.signal);if(aq!==undefined){l(n[aq][1],function(ar){setTimeout(function(){ar.abort()})});n.splice(aq,1)}}});var ap={request:[],response:[]};function V(aq){return function(ar){if(aq.indexOf(ar)===-1){aq.push(ar)}}}function a(aq){try{var ar=JSON.stringify(aq.body)}catch(at){ar=""}this.status=aq.status;this.responseHeaders=aq.headers;this.response=ar;this.responseText=ar}d(a.prototype,{getAllResponseHeaders:function(){var aq="";var at=this.responseHeaders;if(at){for(var ar in at){if(at.hasOwnProperty(ar)){aq+=ar+": "+at[ar]+"\n"}}}return aq}});function D(aq){var at=aq.$Promise||Promise;var ar=at.resolve(aq,aq.$context);l(ap.request,function(au){ar=ar.then(function(av){return new at(function(aw){au(av,function(){aw(av)})},aq.$context)}).catch(function(av){console.error(av)})});return ar}function z(ar,aq){var au=ar.$Promise||Promise;var at=au.resolve(aq,ar.$context);l(ap.response,function(av){at=at.then(function(aw){return new au(function(ax){av(aw,function(ay){if(ay&&ay.constructor!==Y){ax(new Y(ar,new a(ay)))}else{ax(aw)}})},ar.$context)}).catch(function(aw){console.error(aw)})});return at}var W={request:{use:V(ap.request)},response:{use:V(ap.response)}};W.request.use(function(ar,aq){if(!y(ar.method==="GET"?ar.params:ar.body)){if(ar.method!=="GET"&&String(ar.bodyType).toLocaleUpperCase()==="JSON_DATA"){ar.setHeader("Content-Type","application/json; charset=utf-8")}else{ar.setHeader("Content-Type","application/x-www-form-urlencoded")}}if(ar.crossOrigin){ar.setHeader("X-Requested-With","XMLHttpRequest")}aq()});function ao(aq){d(this,{url:"",body:null,params:null,signal:null},aq);this.ABORT_RESPONSE=undefined;this.method=String(this.method).toLocaleUpperCase();this.crossOrigin=E(this);if(this.jsonp){this.script=document.createElement("script")}else{this.xhr=x(this.getXMLHttpRequest)?this.getXMLHttpRequest(this):new XMLHttpRequest()}M(this)}d(ao.prototype,{abort:function(aq){this.xhr.abort(aq)},setHeader:function(aq,ar){this.headers[aq]=ar},getHeader:function(){return this.headers[name]},deleteHeader:function(aq){delete this.headers[aq]},clearHeader:function(){this.headers={}},getUrl:function(){var aq=this.url;var ar="";if(aq){if(x(this.transformParams)){this.params=this.transformParams(this.params||{},this)}if(this.params&&!y(this.params)){ar=x(this.paramsSerializer)?this.paramsSerializer(this.params,this):h(this.params)
}if(ar){aq+=(aq.indexOf("?")===-1?"?":"&")+ar}if(/\w+:\/{2}.*/.test(aq)){return aq}if(aq.indexOf("/")===0){return e()+aq}return this.baseURL.replace(/\/$/,"")+"/"+aq}return aq},getBody:function(){var aq=this;var ar=aq.$Promise||Promise;return new ar(function(av,au){var at=null;if(aq.body&&aq.method!=="GET"){try{if(x(aq.transformBody)){aq.body=aq.transformBody(aq.body||{},aq)||aq.body}if(x(aq.stringifyBody)){at=aq.stringifyBody(aq.body,aq)||null}else{if(y(aq.body)){at=aq.body}else{if(String(aq.bodyType).toLocaleUpperCase()==="FORM_DATA"){at=h(aq.body)}else{at=JSON.stringify(aq.body)}}}}catch(aw){console.error(aw)}}av(at)},aq.$context)}});function s(ar,aq){this.locked=false;this._xhr=ar;this._request=aq}d(s.prototype,{_getBody:function(){var ar=this;var au=this._xhr;var aq=this._request;var at=aq.$Promise||Promise;return new at(function(ax,aw){var av={responseText:"",response:au};if(au&&au.response!==undefined&&au.status!==undefined){if(au.responseText){av.responseText=au.responseText;try{av.response=JSON.parse(au.responseText)}catch(ay){av.response=null}}else{av.response=au.response;av.responseText=JSON.stringify(au.response)}}else{av.responseText=JSON.stringify(av.response)}if(ar.locked){aw(new TypeError("body stream already read"))}else{ar.locked=true;ax(av)}},aq.$context)}});function Y(at,av){var ar=this;var aq={};aq.body=new s(av,at);aq.bodyUsed=false;aq.url=at.url;aq.headers=new P();aq.status=0;aq.statusText="";aq.ok=false;aq.redirected=false;aq.type="basic";l(["body","bodyUsed","url","headers","status","statusText","ok","redirected","type"],function(aw){Object.defineProperty(ar,aw,{get:function(){return aq[aw]}})});this.json=function(){return this.body._getBody().then(function(aw){aq.bodyUsed=true;return aw.response})};this.text=function(){return aq.body._getBody().then(function(aw){aq.bodyUsed=true;return aw.responseText})};if(av&&av.response!==undefined&&av.status!==undefined){aq.status=av.status;aq.redirected=aq.status===302;aq.ok=at.getPromiseStatus(this);if(aq.status===1223||aq.status===204){aq.statusText="No Content"}else{if(aq.status===304){aq.statusText="Not Modified"}else{aq.statusText=(av.statusText||aq.statusText).trim()}}if(av.getAllResponseHeaders){var au=av.getAllResponseHeaders().trim();if(au){l(au.split("\n"),function(ax){var aw=ax.indexOf(":");aq.headers.set(ax.slice(0,aw).trim(),ax.slice(aw+1).trim())})}}}}var b=typeof window==="undefined"?this:window;var ad={method:"GET",baseURL:w(),async:true,credentials:"same-origin",bodyType:"JSON_DATA",headers:{Accept:"application/json, text/plain, */*;"},getPromiseStatus:function(aq){return aq.status>=200&&aq.status<300}};function c(aq){var ar=d({},ad,{headers:d({},ad.headers)},aq);var at=ar.$Promise||Promise;return new at(function(av,au){return(ar.jsonp?k:ab)(new ao(ar),av,au)},ar.$context)}function F(aq,au,at,ar){z(aq,new Y(aq,au)).then(function(av){at(av)})}function ab(aq,at,ar){var au=aq.xhr;D(aq).then(function(){au.open(aq.method,aq.getUrl(),aq.async!==false);if(aq.timeout&&!isNaN(aq.timeout)){au.timeout=aq.timeout}C(aq.headers,function(aw,av){au.setRequestHeader(av,aw)});au.onreadystatechange=function(){if(au.readyState===4){F(aq,au,at,ar)}};if(aq.credentials==="include"){au.withCredentials=true}else{if(aq.credentials==="omit"){au.withCredentials=false}}aq.getBody().then(function(av){au.send(av)}).catch(function(){au.send()})})}var j=0;function k(at,av,au){var aq=at.script;var ar=at.getUrl();if(!at.jsonpCallback){at.jsonpCallback="_xeajax_jsonp"+(++j)}b[at.jsonpCallback]=function(aw){o(at,{status:200,response:aw},av,au)};aq.type="text/javascript";aq.src=ar+(ar.indexOf("?")===-1?"?":"&")+at.jsonp+"="+at.jsonpCallback;aq.onerror=function(aw){o(at,{status:500,response:null},av,au)};if(x(at.sendJSONP)){at.sendJSONP(aq,at,av,au)}else{document.body.appendChild(aq)}}function o(ar,av,au,at){var aq=new Y(ar,av);delete b[ar.jsonpCallback];if(x(ar.sendEndJSONP)){ar.sendEndJSONP(ar.script,ar)}else{document.body.removeChild(ar.script)}aq.json().then(function(aw){(aq.ok?au:at)(aw)}).catch(function(aw){at(aw)})}var m=function m(aq){d(ad,aq)};function ai(au,at,aq){var ar=d({method:au,$context:c.$context,$Promise:c.$Promise},at,aq);ak(c);return ar}function ag(aq){return function(){return R(aq.apply(this,arguments))}}function an(aq){return function(){var ar=aq.apply(this,arguments);var at=ar.$Promise||Promise;return R(ar).then(function(au){return new at(function(aw,av){au.json().then(function(ax){(au.ok?aw:av)(ax)}).catch(function(ax){av(ax)})},this)})}}var R=c;function t(ar){var at=c.$Promise||Promise;var aq=c.$context;ak(c);return at.all(ar.map(function(au){if(au instanceof at){return au}else{if(au&&X(au)){return R(d({$context:aq,$Promise:at},au))}}return au}),aq)}function aa(aq,at,ar){return ai("GET",X(aq)?{}:{url:aq,params:at},ar)}function I(ar,aq,at){return ai("POST",X(ar)?{}:{url:ar,body:aq},at)}function L(ar,aq,at){return ai("PUT",X(ar)?{}:{url:ar,body:aq},at)}function q(ar,aq,at){return ai("DELETE",X(ar)?{}:{url:ar,body:aq},at)}function Q(ar,aq,at){return ai("PATCH",X(ar)?{}:{url:ar,body:aq},at)
}function B(ar,aq,at){return ai("HEAD",X(ar)?{}:{url:ar,body:aq},at)}function r(aq,at,ar){return c(ai("GET",{url:aq,params:at,jsonp:"callback"},ar))}var G=ag(B);var v=ag(aa);var K=ag(I);var f=ag(L);var u=ag(Q);var i=ag(q);var p=an(B);var Z=an(aa);var ac=an(I);var g=an(L);var A=an(Q);var ah=an(q);var O=H;var aj="3.1.6";var S={doAll:t,ajax:R,fetchGet:v,fetchPost:K,fetchPut:f,fetchDelete:i,fetchPatch:u,fetchHead:G,getJSON:Z,postJSON:ac,putJSON:g,deleteJSON:ah,patchJSON:A,headJSON:p,jsonp:r,setup:m,serialize:h,interceptors:W,version:aj};function am(aq){C(aq,function(at,ar){c[ar]=x(at)?function(){var au=at.apply(c.$context,arguments);ak(c);return au}:at})}function af(aq){aq.install(c)}am(S);c.use=af;c.mixin=am;c.AjaxController=O;return c}));