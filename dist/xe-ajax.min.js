/*!
 * xe-ajax.js v3.0.7
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.XEAjax=a())}(this,function(){var B=Array.isArray||function(ae){return ae?ae.constructor===Array:false};function t(ae){return typeof FormData!=="undefined"&&ae instanceof FormData}function x(ae){if(/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(ae.url)){if(RegExp.$1!==location.protocol||RegExp.$2.split("/")[0]!==location.host){return true}}return false}function O(ae){return ae&&typeof ae==="object"}function s(ae){return typeof ae==="function"}function K(ag,ah,af){for(var ae in ag){if(ag.hasOwnProperty(ae)){ah.call(af,ag[ae],ae,ag)}}}function V(af,ah,ag){var ae=[];K(af,function(aj,ai){if(O(aj)){ae=ae.concat(V(aj,ah+"["+ai+"]",B(aj)))}else{ae.push(encodeURIComponent(ah+"["+(ag?"":ai)+"]")+"="+encodeURIComponent(aj))}});return ae}function f(ae){var af=[];K(ae,function(ah,ag){if(ah!==undefined){if(O(ah)){af=af.concat(V(ah,ag,B(ah)))}else{af.push(encodeURIComponent(ag)+"="+encodeURIComponent(ah))}}});return af.join("&").replace(/%20/g,"+")}var c=Object.assign||function(ai){for(var ah,af=1,ae=arguments.length;af<ae;af++){ah=arguments[af];for(var ag in ah){if(ah.hasOwnProperty(ag)){ai[ag]=ah[ag]}}}return ai};function j(ai,ah,ag){if(ai.forEach){ai.forEach(ah,ag)}for(var af=0,ae=ai.length||0;af<ae;af++){ah.call(ag||a,ai[af],af,ai)}}function Z(ae){return String(ae).toLowerCase()}function G(){this._state={};this.set=function(ae,af){this._state[Z(ae)]=[af]};this.get=function(ae){var af=Z(ae);return this.has(af)?this._state[af].join(", "):null};this.append=function(ae,ag){var af=Z(ae);if(this.has(af)){return this._state[af].push(ag)}else{this.set(af,ag)}};this.has=function(ae){return !!this._state[Z(ae)]};this["delete"]=function(ae){delete this._state[Z(ae)]}}var l=[];function E(ag){for(var af=0,ae=l.length;af<ae;af++){if(ag===l[af][0]){return af}}}function D(af){if(af.signal){var ae=E(af.signal);if(ae===undefined){l.push([af.signal,[af]])}else{l[ae][1].push(af)}}}function L(){}function A(){this.signal=new L()}c(A.prototype,{abort:function(){var ae=E(this.signal);if(ae!==undefined){j(l[ae][1],function(af){setTimeout(function(){af.abort()})});l.splice(ae,1)}}});var z=[];var I=[];function M(ae){return function(af){if(ae.indexOf(af)===-1){ae.push(af)}}}function P(af,ae){var ag=Promise.resolve(ae);j(af,function(ah){ag=ag.then(function(ai){return new Promise(function(aj){ah(ai,function(){aj(ai)})})}).catch(function(ai){console.error(ai)})});return ag}function w(ae){return P(z,ae)}function u(ae){return P(I,ae)}var N={request:{use:M(z)},response:{use:M(I)}};N.request.use(function(af,ae){if(!t(af.method==="GET"?af.params:af.body)){if(af.method!=="GET"&&String(af.bodyType).toLocaleUpperCase()==="JSON_DATA"){af.setHeader("Content-Type","application/json; charset=utf-8")}else{af.setHeader("Content-Type","application/x-www-form-urlencoded")}}if(af.crossOrigin){af.setHeader("X-Requested-With","XMLHttpRequest")}ae()});function ac(ae){c(this,{url:"",body:null,params:null,signal:null},ae);this.ABORT_RESPONSE=undefined;this.method=String(this.method).toLocaleUpperCase();this.crossOrigin=x(this);if(ae&&ae.jsonp){this.script=document.createElement("script")}else{this.xhr=ae.getXMLHttpRequest(this)}D(this)}c(ac.prototype,{abort:function(ae){this.xhr.abort(ae)},setHeader:function(ae,af){this.headers[ae]=af},getHeader:function(){return this.headers[name]},deleteHeader:function(ae){delete this.headers[ae]},clearHeader:function(){this.headers={}},getUrl:function(){var ae=this.url;var af="";if(ae){if(s(this.transformParams)){this.params=this.transformParams(this.params||{},this)}if(this.params&&!t(this.params)){af=s(this.paramsSerializer)?this.paramsSerializer(this.params,this):f(this.params)}if(af){ae+=(ae.indexOf("?")===-1?"?":"&")+af}if(/\w+:\/{2}.*/.test(ae)){return ae}return this.baseURL.replace(/\/$/,"")+"/"+ae.replace(/^\//,"")}return ae},getBody:function(){var ae=this;return new Promise(function(ah,ag){var af=null;if(ae.body&&ae.method!=="GET"){try{if(s(ae.transformBody)){ae.body=ae.transformBody(ae.body||{},ae)||ae.body}if(s(ae.stringifyBody)){af=ae.stringifyBody(ae.body,ae)||null}else{if(t(ae.body)){af=ae.body}else{if(String(ae.bodyType).toLocaleUpperCase()==="FROM_DATA"){af=f(ae.body)}else{af=JSON.stringify(ae.body)}}}}catch(ai){console.error(ai)}}ah(af)})}});function o(ae){this.locked=false;this._xhr=ae}c(o.prototype,{_getBody:function(){var ae=this;var af=this._xhr;return new Promise(function(ai,ah){var ag={responseText:"",response:af};if(af&&af.response!==undefined&&af.status!==undefined){if(af.responseText){ag.responseText=af.responseText;try{ag.response=JSON.parse(af.responseText)}catch(aj){ag.response=null}}else{ag.response=af.response;ag.responseText=JSON.stringify(af.response)}}else{ag.responseText=JSON.stringify(ag.response)}if(ae.locked){ah(new TypeError("body stream already read"))}else{ae.locked=true;ai(ag)}})}});function Q(af,ah){var ae=this;
this.body=new o(ah);this.bodyUsed=false;this.url=af.url;this.headers=new G();this.status=0;this.statusText="";this.ok=false;this.redirected=false;this.type="basic";this.json=function(){return this.body._getBody().then(function(ai){ae.bodyUsed=true;return ai.response})};this.text=function(){return this.body._getBody().then(function(ai){ae.bodyUsed=true;return ai.responseText})};if(ah&&ah.response!==undefined&&ah.status!==undefined){this.status=ah.status;this.redirected=this.status===302;this.ok=af.getPromiseStatus(this);if(this.status===1223||this.status===204){this.statusText="No Content"}else{if(this.status===304){this.statusText="Not Modified"}else{this.statusText=(ah.statusText||this.statusText).trim()}}if(ah.getAllResponseHeaders){var ag=ah.getAllResponseHeaders().trim();if(ag){j(ag.split("\n"),function(aj){var ai=aj.indexOf(":");this.headers.set(aj.slice(0,ai).trim(),aj.slice(ai+1).trim())},this)}}}}var a=typeof window==="undefined"?this:window;var U={method:"GET",baseURL:location.origin,async:true,credentials:true,bodyType:"JSON_DATA",headers:{Accept:"application/json, text/plain, */*;"},getXMLHttpRequest:function(){return new XMLHttpRequest()},getPromiseStatus:function(ae){return(ae.status>=200&&ae.status<300)||ae.status===304}};function b(ae){return new Promise(function(ag,af){return(ae&&ae.jsonp?i:S)(new ac(c({},U,{headers:c({},U.headers)},ae)),ag,af)})}function y(ae,ah,ag,af){u(new Q(ae,ah)).then(function(ai){ag(ai)})}function S(ae,ag,af){var ah=ae.xhr;w(ae).then(function(){ah.open(ae.method,ae.getUrl(),ae.async!==false);if(ae.timeout&&!isNaN(ae.timeout)){ah.timeout=ae.timeout}K(ae.headers,function(aj,ai){ah.setRequestHeader(ai,aj)});ah.onreadystatechange=function(){if(ah.readyState===4){y(ae,ah,ag,af)}};if(ae.credentials==="include"){ah.withCredentials=true}else{if(ae.credentials==="omit"){ah.withCredentials=false}}ae.getBody().then(function(ai){ah.send(ai)}).catch(function(){ah.send()})})}var h=0;function i(ag,ai,ah){var ae=ag.script;var af=ag.getUrl();if(!ag.jsonpCallback){ag.jsonpCallback="_xeajax_jsonp"+(++h)}a[ag.jsonpCallback]=function(aj){m(ag,{status:200,response:aj},ai,ah)};ae.type="text/javascript";ae.src=af+(af.indexOf("?")===-1?"?":"&")+ag.jsonp+"="+ag.jsonpCallback;ae.onerror=function(aj){m(ag,{status:500,response:null},ai,ah)};if(s(ag.sendJSONP)){ag.sendJSONP(ae,ag,ai,ah)}else{document.body.appendChild(ae)}}function m(af,ai,ah,ag){var ae=new Q(af,ai);delete a[af.jsonpCallback];if(s(af.sendEndJSONP)){af.sendEndJSONP(af.script,af)}else{document.body.removeChild(af.script)}ae.json().then(function(aj){(ae.ok?ah:ag)(aj)}).catch(function(aj){ag(aj)})}var k=function k(ae){c(U,ae)};function ad(ag,af,ae){return b(c({method:ag},af,ae))}function ab(ae){return function(){return ae.apply(this,arguments).then(function(af){return new Promise(function(ah,ag){af.json().then(function(ai){(af.ok?ah:ag)(ai)}).catch(function(ai){ag(ai)})})})}}var H=b;function p(ae){return Promise.all(ae.map(function(af){if(af instanceof Promise){return af}else{if(af&&O(af)){return H(af)}}return af}))}function r(ae,ag,af){return ad("GET",O(ae)?{}:{url:ae,params:ag},af)}function C(af,ae,ag){return ad("POST",O(af)?{}:{url:af,body:ae},ag)}function d(af,ae,ag){return ad("PUT",O(af)?{}:{url:af,body:ae},ag)}function q(af,ae,ag){return ad("PATCH",O(af)?{}:{url:af,body:ae},ag)}function g(af,ae,ag){return ad("DELETE",O(af)?{}:{url:af,body:ae},ag)}function n(ae,ag,af){return ad("GET",{url:ae,params:ag,jsonp:"callback"},af)}var R=ab(r);var T=ab(C);var e=ab(d);var v=ab(q);var X=ab(g);var F=A;var Y="3.0.7";var J={doAll:p,fetchGet:r,getJSON:R,fetchPost:C,postJSON:T,fetchPut:d,putJSON:e,fetchPatch:q,patchJSON:v,fetchDelete:g,deleteJSON:X,jsonp:n,setup:k,serialize:f,interceptors:N,AjaxController:F,version:Y};function aa(ae){return c(b,ae)}function W(ae){ae.install(b)}aa(J);b.use=W;b.mixin=aa;return b}));