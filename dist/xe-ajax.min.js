/**
 * xe-ajax.js v3.4.1
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 * @preserve
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.XEAjax=e()}(this,function(){"use strict";function t(t){return!!t&&t.constructor===Array}function e(n,o,r){var s=[];return _.objectEach(n,function(n,i){_.isPlainObject(n)||t(n)?s=s.concat(e(n,o+"["+i+"]",t(n))):s.push(T(o+"["+(r?"":i)+"]")+"="+T(n))}),s}function n(t){return String(t).toLowerCase()}function o(t,e){this.$index=0,this.$list=function(t,e){var n=[];for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];n.push([o,r,[o,r]][e])}return n}(t,e),this.next=function(){return function(t,e){var n=t.$index++>=t.$list.length;return{done:n,value:n?void 0:e}}(this,this.$list[this.$index])}}function r(t){this._map={},t instanceof F?t.forEach(function(t,e){this.set(e,t)},this):_.objectEach(t,function(t,e){this.set(e,t)},this)}function s(){this.onaborted=null,this._abortSignal={aborted:!1}}function i(t){for(var e=0,n=q.length;e<n;e++)if(t===q[e][0])return e}function a(){this.signal=new s}function u(t,e){-1===_.arrayIndexOf(t,e)&&t.push(e)}function c(t){return function(e,n){u(t.resolves,e),u(t.rejects,n)}}function f(t,e,n){var o=e.$Promise||Promise,r=o.resolve(n,e.$context);return _.arrayEach(t,function(t){r=r.then(function(n){return new o(function(o){t(n,function(t){t&&t.body&&t.status?o(X.toResponse(t,e)):o(n)},e)},e.$context)}).catch(function(t){console.error(t)})}),r}function d(t){_.objectAssign(this,{url:"",body:null,params:null,signal:null},t),this.headers=new F(t.headers),this.method=String(this.method).toLocaleUpperCase(),this.bodyType=String(this.bodyType).toLowerCase(),this.signal&&_.isFunction(this.signal.install)&&this.signal.install(this)}function h(t,e,n){this._body=t,this._request=n,this._response={body:new function(t,e,n){this.locked=!1,this._getBody=function(){var o=this,r=e.$Promise||Promise;return n._response.bodyUsed=!0,new r(function(e,n){o.locked?n(new TypeError("body stream already read")):(o.locked=!0,e(t))},e.$context)}}(t,n,this),bodyUsed:!1,url:n.url,status:e.status,statusText:e.statusText,redirected:302===e.status,headers:new F(e.headers||{}),type:"basic"},this._response.ok=n.validateStatus(this)}function l(t,e){return new(t.$Promise||Promise)(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}},t.$context)}function p(t){return new TypeError(t)}function y(t,e,n){var o=null,r=t.$fetch||self.fetch,s={_request:t,method:t.method,cache:t.cache,credentials:t.credentials,body:t.getBody(),headers:t.headers};t.timeout&&(o=setTimeout(function(){N.responseRejects(t,z.timeout(),e,n)},t.timeout)),t.signal&&t.signal.aborted?N.responseRejects(t,z.aborted(),e,n):r(t.getUrl(),s).then(function(r){clearTimeout(o),N.responseResolves(t,X.toResponse(r,t),e,n)}).catch(function(r){clearTimeout(o),N.responseRejects(t,r,e,n)})}function b(t){t.script.parentNode===document.body&&document.body.removeChild(t.script);try{delete K[t.jsonpCallback]}catch(e){K[t.jsonpCallback]=void 0}}function m(t,e,n,o){b(t),N.responseRejects(t,e,n,o)}function g(t){var e=_.objectAssign({},A,{headers:_.objectAssign({},A.headers)},t);return new(e.$Promise||Promise)(function(t,n){(e.jsonp?Q.sendJSONP:M.fetchRequest)(new d(e),t,n)},e.$context)}function v(t,e,n){var o=_.objectAssign({method:t,$context:g.$context,$Promise:g.$Promise},e,n);return _.clearContext(g),o}function j(t){return function(){return g(t.apply(this,arguments))}}function x(t,e,n,o,r){return t?{data:e,status:n,statusText:o,headers:r}:e}function R(t,e){return function(){var n=t.apply(this,arguments),o=n.$Promise||Promise;return g(n).catch(function(t){return o.reject(x(e,null,"failed",t.message||t,{}),this)}).then(function(t){return new o(function(n,o){var r=t.ok?n:o;t.clone().json().catch(function(e){return t.clone().text()}).then(function(n){r(x(e,n,t.status,t.statusText,function(t){var e={};return t.headers.forEach(function(t,n){e[n]=t}),e}(t)))})},this)})}}function w(t){return R(t,!0)}function O(t){return R(t)}function P(t){return function(e,n){return v(t,{url:e},n)}}function $(t,e){return function(n,o,r){return v(t,_.objectAssign({url:n,params:o},e),r)}}function E(t){return function(e,n,o){return v(t,{url:e,body:n},o)}}var T=encodeURIComponent,S="undefined"==typeof window&&"undefined"!=typeof process,_={isNodeJS:S,isFetch:!S&&"undefined"!==self.fetch,isSupportAdvanced:!("undefined"==typeof Blob||"undefined"==typeof FormData||"undefined"==typeof FileReader),isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isCrossOrigin:function(t){return!(S||!/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(t)||RegExp.$1===location.protocol&&RegExp.$2.split("/")[0]===location.host)},isString:function(t){return"string"==typeof t},isObject:function(t){return t&&"object"==typeof t},isPlainObject:function(t){return!!t&&t.constructor===Object},isFunction:function(t){return"function"==typeof t},getLocatOrigin:function(){return S?"":location.origin||location.protocol+"//"+location.host},getBaseURL:function(){if(S)return"";var t=location.pathname,e=function(t,e){for(var n=t.length-1;n>=0;n--)if(e===t[n])return n;return-1}(t,"/")+1;return _.getLocatOrigin()+(e===t.length?t:t.substring(0,e))},objectEach:function(t,e,n){for(var o in t)t.hasOwnProperty(o)&&e.call(n,t[o],o,t)},serialize:function(n){var o=[];return _.objectEach(n,function(n,r){void 0!==n&&(_.isPlainObject(n)||t(n)?o=o.concat(e(n,r,t(n))):o.push(T(r)+"="+T(n)))}),o.join("&").replace(/%20/g,"+")},objectAssign:Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}return t},arrayIndexOf:function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,o=t.length;n<o;n++)if(e===t[n])return n;return-1},arrayEach:function(t,e,n){if(t.forEach)t.forEach(e,n);else for(var o=0,r=t.length;o<r;o++)e.call(n,t[o],o,t)},clearContext:function(t){t.$context=t.$Promise=null}},A={method:"GET",baseURL:_.getBaseURL(),cache:"default",credentials:"same-origin",bodyType:"json-data",log:!1,headers:{Accept:"application/json, text/plain, */*"},validateStatus:function(t){return t.status>=200&&t.status<300}},C=r.prototype;C.set=function(t,e){this._map[n(t)]=e},C.get=function(t){var e=n(t);return this.has(e)?this._map[e]:null},C.append=function(t,e){var o=n(t);this.has(o)?this._map[o]=this._map[o]+", "+e:this._map[o]=""+e},C.has=function(t){return this._map.hasOwnProperty(n(t))},C.keys=function(){return new o(this._map,0)},C.values=function(){return new o(this._map,1)},C.entries=function(){return new o(this._map,2)},C.delete=function(t){delete this._map[n(t)]},C.forEach=function(t,e){_.objectEach(this._map,function(n,o,r){t.call(e,n,o,r)})};var F="undefined"==typeof Headers?r:Headers;Object.defineProperty(s.prototype,"aborted",{get:function(){return this._abortSignal.aborted}});var q=[];s.prototype.install=function(t){if(t.signal){var e=i(t.signal);void 0===e?q.push([t.signal,[t]]):q[e][1].push(t)}},a.prototype.abort=function(){var t=i(this.signal);void 0!==t&&(_.arrayEach(q[t][1],function(e){e.abort(),q[t][0]._abortSignal.aborted=!0}),q.splice(t,1))};var H="undefined"==typeof AbortController?a:AbortController,B={resolves:[],rejects:[]},D={resolves:[],rejects:[]},J={request:{use:c(B)},response:{use:c(D)}};J.request.use(function(t,e){t.body&&"GET"!==t.method&&"HEAD"!==t.method&&(_.isFormData(t.body)||(t.headers.set("Content-Type","application/x-www-form-urlencoded"),"json-data"===t.bodyType&&t.headers.set("Content-Type","application/json; charset=utf-8"))),_.isCrossOrigin(t.getUrl())&&t.headers.set("X-Requested-With","XMLHttpRequest"),e()});var N={interceptors:J,requests:function(t){var e=t.$Promise||Promise,n=e.resolve(t,t.$context);return _.arrayEach(B.resolves,function(o){n=n.then(function(n){return new e(function(t){o(n,function(){t(n)})},t.$context)}).catch(function(t){console.error(t)})}),n},responseResolves:function(t,e,n,o){f(D.resolves,t,e).then(n)},responseRejects:function(t,e,n,o){f(D.rejects,t,e).then(function(t){(X.isResponse(t)?n:o)(t)})}},U=d.prototype;U.abort=function(){this.xhr&&this.xhr.abort(),this.$abort=!0},U.getUrl=function(){var t=this.url,e="";if(t){var n=_.arrayIndexOf(["no-store","no-cache","reload"],this.cache)?{_t:Date.now()}:{};return _.isFunction(this.transformParams)&&(this.params=this.transformParams(this.params||{},this)),(e=this.params&&!_.isFormData(this.params)?_.isString(this.params)?this.params:(_.isFunction(this.paramsSerializer)?this.paramsSerializer:_.serialize)(_.objectAssign(n,this.params),this):_.serialize(n))&&(t+=(-1===t.indexOf("?")?"?":"&")+e),/\w+:\/{2}.*/.test(t)?t:0===t.indexOf("//")?(_.isNodeJS?"":location.protocol)+t:0===t.indexOf("/")?_.getLocatOrigin()+t:this.baseURL.replace(/\/$/,"")+"/"+t}return t},U.getBody=function(){var t=null,e=this.body;if(e&&"GET"!==this.method&&"HEAD"!==this.method)try{_.isFunction(this.transformBody)&&(e=this.body=this.transformBody(e,this)||e),t=_.isFunction(this.stringifyBody)?this.stringifyBody(e,this)||null:_.isFormData(e)?e:_.isString(e)?e:"form-data"===this.bodyType?_.serialize(e):JSON.stringify(e)}catch(t){console.error(t)}return t},_.arrayEach(["body","bodyUsed","url","headers","status","statusText","ok","redirected","type"],function(t){Object.defineProperty(h.prototype,t,{get:function(){return this._response[t]}})});var k=decodeURIComponent,L=h.prototype;L.clone=function(){if(this.bodyUsed)throw new TypeError("Failed to execute 'clone' on 'Response': Response body is already used");return new h(this._body,this,this._request)},L.json=function(){return this.text().then(function(t){return JSON.parse(t)})},L.text=function(){return this.body._getBody(this)},_.isSupportAdvanced&&(L.text=function(){var t=this._request;return this.blob().then(function(e){var n=new FileReader,o=l(t,n);return n.readAsText(e),o})},L.blob=function(){return this.body._getBody(this)},L.arrayBuffer=function(){var t=this._request;return this.blob().then(function(e){var n=new FileReader,o=l(t,n);return n.readAsArrayBuffer(e),o})},L.formData=function(){return this.text().then(function(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),o=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(k(o),k(r))}}),e})});var X={isResponse:function(t){return!!t&&("undefined"!=typeof Response&&t.constructor===Response||t.constructor===h)},toResponse:function(t,e){if(X.isResponse(t))return t;var n={status:t.status,statusText:t.statusText,headers:t.headers};return _.isSupportAdvanced?new h(t.body instanceof Blob?t.body:new Blob([_.isString(t.body)?t.body:JSON.stringify(t.body)]),n,e):new h(_.isString(t.body)?t.body:JSON.stringify(t.body),n,e)}},z={aborted:function(){return p("The user aborted a request.")},timeout:function(){return p("Request timeout.")},failed:function(){return p("Network request failed.")}},G={sendXHR:function(t,e,n){var o=t.$XMLHttpRequest||XMLHttpRequest,r=t.xhr=new o;r._request=t,r.open(t.method,t.getUrl(),!0),t.timeout&&setTimeout(function(){r.abort()},t.timeout),t.headers.forEach(function(t,e){r.setRequestHeader(e,t)}),r.onload=function(){N.responseResolves(t,new h(r.response,{status:r.status,statusText:r.statusText,headers:function(t){var e={},n=t.getAllResponseHeaders().trim();return n&&_.arrayEach(n.split("\n"),function(t){var n=t.indexOf(":");e[t.slice(0,n).trim()]=t.slice(n+1).trim()}),e}(r)},t),e,n)},r.onerror=function(){N.responseRejects(t,z.failed(),e,n)},r.ontimeout=function(){N.responseRejects(t,z.timeout(),e,n)},r.onabort=function(){N.responseRejects(t,z.aborted(),e,n)},_.isSupportAdvanced&&(r.responseType="blob"),"include"===t.credentials?r.withCredentials=!0:"omit"===t.credentials&&(r.withCredentials=!1),r.send(t.getBody()),t.$abort&&r.abort()}},I=_.isNodeJS?httpExports.sendHttp:_.isFetch?function(t,e,n){return function(t){return t.$fetch?t.signal?G.sendXHR:y:_.isFetch?"undefined"!=typeof AbortController&&"undefined"!=typeof AbortSignal?y:t.signal?G.sendXHR:y:G.sendXHR}(t).apply(this,arguments)}:G.sendXHR,M={fetchRequest:function(t,e,n){return N.requests(t).then(function(){return I(t,e,n)})}},W=0,K="undefined"==typeof window?this:window,Q={sendJSONP:function(t,e,n){t.script=document.createElement("script"),N.requests(t).then(function(){var o=t.script;if(t.jsonpCallback||(t.jsonpCallback="jsonp_xeajax_"+Date.now()+"_"+ ++W),_.isFunction(t.$jsonp))return t.$jsonp(o,t).then(function(o){N.responseResolves(t,X.toResponse({status:200,body:o},t),e,n)}).catch(function(o){N.responseRejects(t,o,e,n)});var r=t.getUrl();K[t.jsonpCallback]=function(n){!function(t,e,n,o){b(t),N.responseResolves(t,X.toResponse(e,t),n,o)}(t,{status:200,body:n},e)},o.type="text/javascript",o.src=r+(-1===r.indexOf("?")?"?":"&")+t.jsonp+"="+t.jsonpCallback,o.onerror=function(o){m(t,z.failed(),e,n)},t.timeout&&setTimeout(function(){m(t,z.timeout(),e,n)},t.timeout),document.body.appendChild(o)})}};g.version="3.4.1",g.use=function(t){t.install(g)},g.setup=function(t){_.objectAssign(A,t)};var V=P("HEAD"),Y=P("DELETE"),Z=$("GET",{jsonp:"callback"}),tt=$("GET"),et=E("POST"),nt=E("PUT"),ot=E("PATCH"),rt={doAll:function(t){var e=g.$Promise||Promise,n=g.$context;return _.clearContext(g),e.all(t.map(function(t){return t instanceof e||t instanceof Promise?t:_.isObject(t)?g(_.objectAssign({$context:n,$Promise:e},t)):t}),n)},ajax:g,fetch:j(P("GET")),fetchGet:j(tt),fetchPost:j(et),fetchPut:j(nt),fetchDelete:j(Y),fetchPatch:j(ot),fetchHead:j(V),fetchJsonp:j(Z),doGet:w(tt),doPost:w(et),doPut:w(nt),doDelete:w(Y),doPatch:w(ot),doHead:w(V),doJsonp:w(Z),getJSON:O(tt),postJSON:O(et),putJSON:O(nt),deleteJSON:O(Y),patchJSON:O(ot),headJSON:O(V),jsonp:O(Z)};return g.mixin=function(t){_.objectEach(t,function(t,e){g[e]=_.isFunction(t)?function(){var e=t.apply(g.$context,arguments);return _.clearContext(g),e}:t})},g.serialize=_.serialize,g.interceptors=N.interceptors,g.AbortController=H,g.mixin(rt),g});