/*!
 * xe-ajax.js v2.6.1
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.XEAjax=a())}(this,function(){var x=Array.isArray||function(Y){return Object.prototype.toString.call(Y)==="[object Array]"};function p(Y){return typeof FormData!=="undefined"&&Y instanceof FormData}function t(Y){if(/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(Y.url)){if(RegExp.$1!==location.protocol||RegExp.$2.split("/")[0]!==location.host){return true}}return false}function D(Y){return Y&&typeof Y==="object"}function k(Y){return typeof Y==="string"}function o(Y){return typeof Y==="function"}function s(Y){return typeof Y==="undefined"}function C(aa,ab,Z){for(var Y in aa){if(aa.hasOwnProperty(Y)){ab.call(Z,aa[Y],Y,aa)}}}function L(Z,ab,aa){var Y=[];C(Z,function(ad,ac){if(D(ad)){Y=Y.concat(L(ad,ab+"["+ac+"]",x(ad)))}else{Y.push(encodeURIComponent(ab+"["+(aa?"":ac)+"]")+"="+encodeURIComponent(ad))}});return Y}function d(Y){var Z=[];C(Y,function(ab,aa){if(ab!==undefined){if(D(ab)){Z=Z.concat(L(ab,aa,x(ab)))}else{Z.push(encodeURIComponent(aa)+"="+encodeURIComponent(ab))}}});return Z.join("&").replace(/%20/g,"+")}function U(Y){Object.assign(this,{body:null,params:null},Y);this.ABORT_RESPONSE=undefined;this.AFTER_SEND_CALLS=[];this.OPTIONS=Y;this.method=String(this.method).toLocaleUpperCase();this.crossOrigin=t(this);if(Y&&Y.jsonp){this.script=document.createElement("script")}else{this.xhr=Y.getXMLHttpRequest(this)}q(this)}Object.assign(U.prototype,{abort:function(Y){this.xhr.abort(Y)},setHeader:function(Y,Z){this.headers[Y]=Z},getHeader:function(){return this.headers[name]},deleteHeader:function(Y){delete this.headers[Y]},clearHeader:function(){this.headers={}},getUrl:function(){var Y=this.url;var Z="";if(Y){if(this.params&&!p(this.params)){Z=o(this.paramsSerializer)?this.paramsSerializer(this):d(this.params)}if(Z){Y+=(Y.indexOf("?")===-1?"?":"&")+Z}if(/\w+:\/{2}.*/.test(Y)){return Y}return this.baseURL.replace(/\/$/,"")+"/"+Y.replace(/^\//,"")}return Y},getBody:function(){var Y=this;return new Promise(function(ab,aa){var Z=null;if(Y.body&&Y.method!=="GET"){try{if(o(Y.transformBody)){Y.body=Y.transformBody(Y.body,Y)||Y.body}if(o(Y.stringifyBody)){Z=Y.stringifyBody(Y.body,Y)||null}else{if(p(Y.body)){Z=Y.body}else{if(String(Y.bodyType).toLocaleUpperCase()==="FROM_DATA"){Z=d(Y.body)}else{Z=JSON.stringify(Y.body)}}}}catch(ac){console.error(ac)}}ab(Z)})}});function F(Y,ab){this.request=Y;this.url=Y.url;this.headers={};this.status=0;this.statusText="";this.bodyText="";if(ab&&ab.response!==undefined&&ab.status!==undefined){this.status=ab.status||this.status;this.body=ab.response;this.bodyText=ab.responseText||"";if(this.status===1223||this.status===204){this.statusText="No Content"}else{if(this.status===304){this.statusText="Not Modified"}else{this.statusText=(ab.statusText||this.statusText).trim()}}if(ab.getAllResponseHeaders){var aa=ab.getAllResponseHeaders().trim();if(aa){aa.split("\n").forEach(function(ad){var ac=ad.indexOf(":");this.headers[ad.slice(0,ac).trim()]=ad.slice(ac+1).trim()},this)}}else{if(ab.headers){Object.assign(this.headers,ab.headers)}}}else{if(ab){this.body=ab}}try{if(this.body&&!this.bodyText){this.bodyText=JSON.stringify(this.body)}}catch(Z){}if(this.body&&k(this.body)){try{this.body=JSON.parse(this.body)}catch(Z){this.body=this.bodyText}}}var a=typeof window==="undefined"?this:window;var W=[];var K={method:"GET",baseURL:location.origin,async:true,credentials:true,bodyType:"JSON_DATA",headers:{Accept:"application/json, text/plain, */*;"},getXMLHttpRequest:function(){return new XMLHttpRequest()},getPromiseStatus:function(Y){return(Y.status>=200&&Y.status<300)||Y.status===304}};function b(Y){return new Promise(function(aa,Z){return(Y&&Y.jsonp?f:I)(new U(Object.assign({},K,{headers:Object.assign({},K.headers)},Y)),aa,Z)})}function j(aa,Y){var Z=Promise.resolve(Y);aa.AFTER_SEND_CALLS.forEach(function(ab){Z=Z.then(function(ac){return ab(ac)||ac}).catch(function(ac){console.error(ac)})});return Z}function u(Z,Y,ab,aa){j(Z,Y).then(function(ac){(Z.OPTIONS.getPromiseStatus(ac)?ab:aa)(ac)})}function T(Y){var Z=Promise.resolve();W.concat(Y.interceptor?[Y.interceptor]:[]).forEach(function(aa){Z=Z.then(function(ab){if(ab){return ab}else{return new Promise(function(ac){aa(Y,function(ad){if(s(ad)){ac()}else{if(o(ad)){Y.AFTER_SEND_CALLS.push(ad);ac()}else{ac(new F(Y,ad))}}})})}}).catch(function(ab){console.error(ab)})});return Z}function I(Y,aa,Z){var ab=Y.xhr;T(Y).then(function(ac){if(ac&&ac.constructor===F){return u(Y,ac,aa,Z)}ab.open(Y.method,Y.getUrl(),Y.async!==false);if(Y.timeout&&!isNaN(Y.timeout)){ab.timeout=Y.timeout}C(Y.headers,function(ae,ad){ab.setRequestHeader(ad,ae)});ab.onreadystatechange=function(){if(ab.readyState===4){u(Y,new F(Y,ab),aa,Z)}};if(Y.credentials==="include"){Y.xhr.withCredentials=true}else{if(Y.credentials==="omit"){Y.xhr.withCredentials=false}}Y.getBody().then(function(ad){ab.send(ad)
}).catch(function(){ab.send()})})}var e=0;function f(aa,ac,ab){var Y=aa.script;var Z=aa.getUrl();if(!aa.jsonpCallback){aa.jsonpCallback="xeajax_jsonp"+(++e)}aa.customCallback=a[aa.jsonpCallback];a[aa.jsonpCallback]=function(ad){i(aa,{status:200,response:ad},ac,ab)};Y.type="text/javascript";Y.src=Z+(Z.indexOf("?")===-1?"?":"&")+aa.jsonp+"="+aa.jsonpCallback;Y.onerror=function(ad){i(aa,{status:500,response:null},ac,ab)};if(o(aa.sendJSONP)){aa.sendJSONP(Y,aa,ac,ab)}else{document.body.appendChild(Y)}}function i(Z,ac,ab,aa){var Y=new F(Z,ac);delete a[Z.jsonpCallback];if(o(Z.sendEndJSONP)){Z.sendEndJSONP(Z.script,Z)}else{document.body.removeChild(Z.script)}if(Z.customCallback){(a[Z.jsonpCallback]=Z.customCallback)(Y)}(Z.OPTIONS.getPromiseStatus(ac)?ab:aa)(Y)}var g=function g(Y){Object.assign(K,Y)};var N={use:function(Y){if(o(Y)){W.push(Y)}return N}};N.use(function(Z,Y){if(!p(Z.method==="GET"?Z.params:Z.body)){if(Z.method!=="GET"&&String(Z.bodyType).toLocaleUpperCase()==="JSON_DATA"){Z.setHeader("Content-Type","application/json; charset=utf-8")}else{Z.setHeader("Content-Type","application/x-www-form-urlencoded")}}if(Z.crossOrigin){Z.setHeader("X-Requested-With","XMLHttpRequest")}Y()});var h=[];var X=0;function S(){this._ID="XEAjax_"+(++X)}function P(Y){return function(aa){var Z={status:Y,response:aa||""};if(aa&&aa.response!==undefined&&aa.status!==undefined){Z=aa}E.call(this,Z)}}function E(Z){var Y=z(this);if(Y!==undefined){h[Y][1].forEach(function(aa){setTimeout(function(){aa.abort(Z)})});h.splice(Y,1)}}Object.assign(S.prototype,{cancel:E,resolve:P(200),reject:P(500)});function z(aa){for(var Z=0,Y=h.length;Z<Y;Z++){if(aa===h[Z][0]){return Z}}}function q(aa){var Z=aa.cancelable;if(Z&&Z.constructor===S){var Y=z(Z);if(Y===undefined){h.push([Z,[aa]])}else{h[Y][1].push(aa)}}}function V(aa,Z,Y){return b(Object.assign({method:aa},Z,Y))}function R(Y){return function(){return Y.apply(this,arguments).then(function(Z){return Z.body}).catch(function(Z){return Promise.reject(Z.body,this)})}}var B=b;function n(Y){return Promise.all(Y.map(function(Z){if(Z instanceof Promise){return Z}else{if(Z&&D(Z)){return B(Z)}}return Z}))}function H(Y,aa,Z){return V("GET",D(Y)?{}:{url:Y,params:aa},Z)}function w(Z,Y,aa){return V("POST",D(Z)?{}:{url:Z,body:Y},aa)}function y(Z,Y,aa){return V("PUT",D(Z)?{}:{url:Z,body:Y},aa)}function A(Z,Y,aa){return V("PATCH",D(Z)?{}:{url:Z,body:Y},aa)}function l(Z,Y,aa){return V("DELETE",D(Z)?{}:{url:Z,body:Y},aa)}function m(Y,aa,Z){return V("GET",{url:Y,params:aa,jsonp:"callback"},Z)}function v(){return new S()}var G=R(H);var J=R(w);var c=R(y);var r=R(A);var O=R(l);function Q(Y){return Object.assign(b,Y)}function M(Y){Y.install(b)}Q({doAll:n,doGet:H,getJSON:G,doPost:w,postJSON:J,doPut:y,putJSON:c,doPatch:A,patchJSON:r,doDelete:l,deleteJSON:O,jsonp:m,cancelable:v,setup:g,interceptor:N});b.use=M;b.mixin=Q;return b}));