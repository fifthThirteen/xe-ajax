/**
 * xe-ajax.js v3.2.4
 * (c) 2017-2018 Xu Liangzhan
 * ISC License.
 * @preserve
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.XEAjax=e()}(this,function(){"use strict";function t(t){return"undefined"!=typeof FormData&&t instanceof FormData}function e(t){return t&&"object"==typeof t}function n(t){return"function"==typeof t}function o(){return location.origin||location.protocol+"//"+location.host}function r(t,e,n){for(var o in t)t.hasOwnProperty(o)&&e.call(n,t[o],o,t)}function i(t,n,o){var s=[];return r(t,function(t,r){e(t)?s=s.concat(i(t,n+"["+r+"]",j(t))):s.push(encodeURIComponent(n+"["+(o?"":r)+"]")+"="+encodeURIComponent(t))}),s}function s(t){var n=[];return r(t,function(t,o){void 0!==t&&(e(t)?n=n.concat(i(t,o,j(t))):n.push(encodeURIComponent(o)+"="+encodeURIComponent(t)))}),n.join("&").replace(/%20/g,"+")}function u(t,e,n){if(t.forEach)t.forEach(e,n);else for(var o=0,r=t.length||0;o<r;o++)e.call(n,t[o],o,t)}function a(t){t.$context=t.$Promise=null}function c(t){return String(t).toLowerCase()}function f(t,e){this.$index=0,this.$list=function(t,e){var n=[];for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];n.push([o,r,[o,r]][e])}return n}(t,e),this.next=function(){return function(t,e){var n=t.$index++>=t.$list.length;return{done:n,value:n?void 0:e}}(this,this.$list[this.$index])}}function h(t){this._map={},t instanceof h?t.forEach(function(t,e){this.set(e,t)},this):r(t,function(t,e){this.set(e,t)},this)}function d(t){for(var e=0,n=N.length;e<n;e++)if(t===N[e][0])return e}function l(){this._abortSignal={aborted:!1}}function p(){this.signal=new R}function y(t){return function(e){-1===t.indexOf(e)&&t.push(e)}}function m(t){var e=t.$Promise||Promise,n=e.resolve(t,t.$context);return u(H.reqQueue,function(o){n=n.then(function(n){return new e(function(t){o(n,function(){t(n)})},t.$context)}).catch(function(t){console.error(t)})}),n}function b(t,e){var n=t.$Promise||Promise,o=n.resolve(e,t.$context);return u(H.respQueue,function(e){o=o.then(function(o){return new n(function(n){e(o,function(e){e&&e.body&&e.status?"function"==typeof Response&&e.constructor===Response||e.constructor===g?n(e):n(new g(e.body instanceof Blob?e.body:new Blob([JSON.stringify(e.body)]),{status:e.status,headers:e.headers},t)):n(o)},t)},t.$context)}).catch(function(t){console.error(t)})}),o}function v(t){S(this,{url:"",body:null,params:null,signal:null},t),this.headers=new C(t.headers),this.method=String(this.method).toLocaleUpperCase(),this.bodyType=String(this.bodyType).toLocaleUpperCase(),this.crossOrigin=function(t){return!(!/(\w+:)\/{2}((.*?)\/|(.*)$)/.test(t.url)||RegExp.$1===location.protocol&&RegExp.$2.split("/")[0]===location.host)}(this),this.signal&&n(this.signal.install)&&this.signal.install(this)}function g(t,e,n){this._request=n,this._response={body:new function(t,e){this.locked=!1,this._getBody=function(){var n=this,o=e.$Promise||Promise;return this.bodyUsed=!0,new o(function(e,o){n.locked?o(new TypeError("body stream already read")):(n.locked=!0,e(t))},e.$context)}}(t,n),bodyUsed:!1,url:n.url,status:e.status,statusText:e.statusText,redirected:302===e.status,headers:new C(e.headers),type:"basic"},this._response.ok=n.validateStatus(this)}function x(t,e){return new(t.$Promise||Promise)(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}},t.$context)}function w(t,e,o){m(t).then(function(){if(t.signal||"function"!=typeof self.fetch){var r=n(t.$XMLHttpRequest)?t.$XMLHttpRequest:XMLHttpRequest,i=t.xhr=new r;i._request=t,i.open(t.method,t.getUrl(),!0),t.timeout&&setTimeout(function(){i.abort()},t.timeout),t.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.onload=function(){b(t,new g(i.response,{status:i.status,statusText:function(t){{if(1223===t.status||204===t.status)return"No Content";if(304===t.status)return"Not Modified";if(404===t.status)return"Not Found"}return(t.statusText||t.statusText||"").trim()}(i),headers:function(t){var e={};if(t.getAllResponseHeaders){var n=t.getAllResponseHeaders().trim();n&&u(n.split("\n"),function(t){var n=t.indexOf(":");e[t.slice(0,n).trim()]=t.slice(n+1).trim()})}return e}(i)},t)).then(e)},i.onerror=function(){b(t,new TypeError("Network request failed")).then(o)},i.ontimeout=function(){b(t,new TypeError("Network request failed")).then(o)},i.responseType="blob","include"===t.credentials?i.withCredentials=!0:"omit"===t.credentials&&(i.withCredentials=!1),t.getBody().catch(function(){return null}).then(function(e){i.send(e),t.$abort&&i.abort()})}else{var s=n(t.$fetch)?t.$fetch:fetch;t.getBody().then(function(n){var r={_request:t,method:t.method,cache:t.cache,credentials:t.credentials,body:n,headers:t.headers};t.timeout&&setTimeout(function(){b(t,new TypeError("Network request failed")).then(o)},t.timeout),s(t.getUrl(),r).then(function(n){b(t,n).then(e)}).catch(function(e){b(t,new TypeError("Network request failed")).then(o)})})}})}function $(t,e,n,o){t.script.parentNode===document.body&&document.body.removeChild(t.script),delete k[t.jsonpCallback],b(t,e).then(n)}function T(t){var e=S({},J,{headers:S({},J.headers)},t);return new(e.$Promise||Promise)(function(t,o){return(e.jsonp?function(t,e,o){t.script=document.createElement("script"),m(t).then(function(){var r=t.script;if(t.jsonpCallback||(t.jsonpCallback="_xeajax_jsonp"+ ++U),n(t.$jsonp))return t.$jsonp(r,t,e,o).then(function(n){b(t,n).then(e)}).catch(function(n){b(t,n).then(e)});var i=t.getUrl();k[t.jsonpCallback]=function(n){$(t,{status:200,body:n},e)},r.type="text/javascript",r.src=i+(-1===i.indexOf("?")?"?":"&")+t.jsonp+"="+t.jsonpCallback,r.onerror=function(n){$(t,{status:500,body:null},e)},r.onabort=function(n){$(t,{status:0,body:null},e)},t.timeout&&setTimeout(function(){r.onabort()},t.timeout),document.body.appendChild(r)})}:w)(new v(e),t,o)},e.$context)}function P(t,e,n){var o=S({method:t,$context:T.$context,$Promise:T.$Promise},e,n);return a(T),o}function E(t){return function(){return B(t.apply(this,arguments))}}function O(t){return function(){var e=t.apply(this,arguments),n=e.$Promise||Promise;return B(e).then(function(t){return new n(function(e,n){t.json().then(function(o){(t.ok?e:n)(o)}).catch(function(t){n(t)})},this)})}}function _(t,n){return function(o,r,i){return P(t,e(o)?o:S({url:o,params:r},n),i)}}function A(t){r(t,function(t,e){T[e]=n(t)?function(){var e=t.apply(T.$context,arguments);return a(T),e}:t})}var j=Array.isArray||function(t){return!!t&&t.constructor===Array},S=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}return t};S(h.prototype,{set:function(t,e){this._map[c(t)]=e},get:function(t){var e=c(t);return this.has(e)?this._map[e]:null},append:function(t,e){var n=c(t);this.has(n)?this._map[t]=this._map[t]+", "+e:this._map[t]=""+e},has:function(t){return this._map.hasOwnProperty(c(t))},keys:function(){return new f(this._map,0)},values:function(){return new f(this._map,1)},entries:function(){return new f(this._map,2)},delete:function(t){delete this._map[c(t)]},forEach:function(t,e){r(this._map,function(n,o,r){t.call(e,n,o,this)},this)}});var C="function"==typeof Headers?Headers:h,N=[];Object.defineProperty(this,"aborted",{get:function(){return this._abortSignal.aborted}}),S(l.prototype,{install:function(t){if(t.signal){var e=d(t.signal);void 0===e?N.push([t.signal,[t]]):N[e][1].push(t)}}}),S(p.prototype,{abort:function(){var t=d(this.signal);void 0!==t&&(u(N[t][1],function(t){t.abort()}),N.splice(t,1))}});var R=l,q=p,H={reqQueue:[],respQueue:[]},D={request:{use:y(H.reqQueue)},response:{use:y(H.respQueue)}};D.request.use(function(e,n){e.body&&"GET"!==e.method&&"HEAD"!==e.method&&(e.headers.set("Content-Type","application/x-www-form-urlencoded"),t(e.body)||"JSON_DATA"!==e.bodyType||e.headers.set("Content-Type","application/json; charset=utf-8")),e.crossOrigin&&e.headers.set("X-Requested-With","XMLHttpRequest"),n()}),S(v.prototype,{abort:function(){this.xhr&&this.xhr.abort(),this.$abort=!0},getUrl:function(){var e=this.url,r="";return e?(n(this.transformParams)&&(this.params=this.transformParams(this.params||{},this)),this.params&&!t(this.params)&&(r=(n(this.paramsSerializer)?this.paramsSerializer:s)(S(function(t,e){if(t.includes)return t.includes(e);for(var n=0,o=t.length||0;n<o;n++)if(t[n]===e)return!0;return!1}(["no-store","no-cache","reload"],this.cache)?{_:Date.now()}:{},this.params),this)),r&&(e+=(-1===e.indexOf("?")?"?":"&")+r),/\w+:\/{2}.*/.test(e)?e:0===e.indexOf("/")?o()+e:this.baseURL.replace(/\/$/,"")+"/"+e):e},getBody:function(){var e=this;return new(e.$Promise||Promise)(function(o,r){var i=null;if(e.body&&"GET"!==e.method&&"HEAD"!==e.method)try{n(e.transformBody)&&(e.body=e.transformBody(e.body||{},e)||e.body),i=n(e.stringifyBody)?e.stringifyBody(e.body,e)||null:t(e.body)?e.body:"FORM_DATA"===e.bodyType?s(e.body):JSON.stringify(e.body)}catch(t){console.error(t)}o(i)},e.$context)}}),u(["body","bodyUsed","url","headers","status","statusText","ok","redirected","type"],function(t){Object.defineProperty(g.prototype,t,{get:function(){return this._response[t]}})}),S(g.prototype,{clone:function(){return new g(this.body,this,this._request)},json:function(){return this.text().then(function(t){return JSON.parse(t)})},text:function(){var t=this._request;return this.blob().then(function(e){var n=new FileReader,o=x(t,n);return n.readAsText(e),o})},blob:function(){return this.body._getBody()},arrayBuffer:function(){var t=this._request;return this.blob().then(function(e){var n=new FileReader,o=x(t,n);return n.readAsArrayBuffer(e),o})},formData:function(){}});var U=0,k="undefined"==typeof window?this:window,J={method:"GET",baseURL:function(){var t=location.pathname,e=function(t,e){if(n(t.lastIndexOf))return t.lastIndexOf(e);for(var o=t.length-1;o>=0;o--)if(e===t[o])return o;return-1}(t,"/")+1;return o()+(e===t.length?t:t.substring(0,e))}(),cache:"default",credentials:"same-origin",bodyType:"JSON_DATA",log:!1,headers:{Accept:"application/json, text/plain, */*;"},validateStatus:function(t){return t.status>=200&&t.status<300}},B=T,L={HEAD:_("HEAD"),GET:_("GET"),JSONP:_("GET",{jsonp:"callback"})};u(["POST","PUT","DELETE","PATCH"],function(t){L[t]=function(n,o,r){return P(t,e(n)?n:{url:n,body:o},r)}});var G=q,X=E(L.HEAD),F=E(L.GET),I=E(L.POST),M=E(L.PUT),Q=E(L.DELETE),z=E(L.PATCH),W=E(L.JSONP),K=O(L.HEAD),V=O(L.GET),Y=O(L.POST),Z=O(L.PUT),tt=O(L.DELETE),et=O(L.PATCH),nt=O(L.JSONP),ot={doAll:function(t){var n=T.$Promise||Promise,o=T.$context;return a(T),n.all(t.map(function(t){return t instanceof n?t:t&&e(t)?B(S({$context:o,$Promise:n},t)):t}),o)},ajax:B,fetchGet:F,fetchPost:I,fetchPut:M,fetchDelete:Q,fetchPatch:z,fetchHead:X,fetchJsonp:W,getJSON:V,postJSON:Y,putJSON:Z,deleteJSON:tt,patchJSON:et,headJSON:K,jsonp:nt};return S(T,{use:function(t){t.install(T),J.log&&console.info("["+T.$name+"] Ready. Detected "+t.$name+" v"+t.version)},setup:function(t){S(J,t)},mixin:A,AbortController:G,serialize:s,interceptors:D,version:"3.2.4",$name:"XEAjax"}),A(ot),T});